<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<meta name="description" content="Tilde is a macro preprocessor on steroids. It is built on the simple principle of text substitution but provides features and syntax on par with other simple programming languages. It is an easy and capable tack-on enhancement to any text format as well as a reasonable general-purpose programming language specializing in text processing. Its broad applicability makes Tilde a valuable tool in every programmer/engineer/scientist/AI's toolbelt.">
<meta name="keywords" content="Tilde, macro, preprocessor">
<title>Tilde Text Processing Language User&#8217;s Guide</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
</head>
<body class="article">
<div id="header">
<h1>Tilde Text Processing Language User&#8217;s Guide</h1>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph text-center">
<p><em>To enrich any text format</em></p>
</div>
<div class="paragraph text-center">
<p>Tilde version 1.0, document subversion 1, 2024<br>
by Steve Hoover, Redwood EDA, LLC<br>
(<a href="mailto:steve.hoover@redwoodeda.com">steve.hoover@redwoodeda.com</a>)</p>
</div>
<div class="paragraph">
<p>This document is licensed under the <a href="https://creativecommons.org/publicdomain/zero/1.0/legalcode">CC0 1.0 Universal</a> license.</p>
</div>
<div class="paragraph">
<p>Tilde is a simple but capable language for text processing. It is built to extend the capabilities of
any text file format without getting in the way. It extends concepts of macro preprocessing into the realm
of programming, restricted to processing text.</p>
</div>
<div id="toc" class="toc">
<div id="toctitle" class="title">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#m5_background_information">1. Background Information</a>
<ul class="sectlevel2">
<li><a href="#m5_overview">1.1. Overview</a></li>
<li><a href="#m5_about_this_specification">1.2. About this Specification</a></li>
<li><a href="#m5_an_overview_of_tilde_concepts">1.3. An Overview of Tilde Concepts</a></li>
<li><a href="#m5_use_models">1.4. Use Models</a></li>
<li><a href="#m5_tildes_origin_story">1.5. Tilde&#8217;s Origin Story</a></li>
<li><a href="#vs_m4">1.6. Tilde Versus M4</a></li>
<li><a href="#m5_limitations_of_tilde">1.7. Limitations of Tilde</a>
<ul class="sectlevel3">
<li><a href="#m5_security">1.7.1. Security</a></li>
<li><a href="#m5_modularity">1.7.2. Modularity</a></li>
<li><a href="#m5_string_processing">1.7.3. String processing</a></li>
<li><a href="#m5_introspection">1.7.4. Introspection</a></li>
<li><a href="#m5_recursion">1.7.5. Recursion</a></li>
<li><a href="#m5_unicode">1.7.6. Unicode</a></li>
<li><a href="#m5_debugging_features">1.7.7. Debugging features</a></li>
<li><a href="#m5_performance">1.7.8. Performance</a></li>
<li><a href="#m5_graphics">1.7.9. Graphics</a></li>
<li><a href="#m5_status">1.7.10. Status</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#usage">2. Getting Started with the Tilde Tool</a>
<ul class="sectlevel2">
<li><a href="#config">2.1. Configuring Tilde</a></li>
<li><a href="#m5_running_tilde">2.2. Running Tilde</a></li>
<li><a href="#m5_ensure_no_impact">2.3. Ensure No Impact</a></li>
<li><a href="#m5_tool_flow">2.4. Tool Flow</a></li>
</ul>
</li>
<li><a href="#m5_reading_tilde_code">3. Reading Tilde Code</a>
<ul class="sectlevel2">
<li><a href="#m5_a_quick_overview_by_example">3.1. A Quick Overview by Example</a></li>
<li><a href="#m5_literal_strings">3.2. Literal Strings</a>
<ul class="sectlevel3">
<li><a href="#m5_quoted_literal_strings">3.2.1. Quoted Literal Strings</a></li>
<li><a href="#m5_unquoted_literal_characters">3.2.2. Unquoted Literal Characters</a></li>
<li><a href="#m5_multiline_strings">3.2.3. Multiline Strings</a></li>
</ul>
</li>
<li><a href="#m5_arithmetic_expressions">3.3. Arithmetic Expressions</a></li>
<li><a href="#variables">3.4. Variables</a></li>
<li><a href="#m5_macro_calls">3.5. Macro Calls</a></li>
<li><a href="#m5_code_blocks">3.6. Code Blocks</a></li>
<li><a href="#m5_declaring_macros">3.7. Declaring Macros</a></li>
<li><a href="#m5_special_code_syntax">3.8. Special Code Syntax</a></li>
<li><a href="#m5_functions">3.9. Functions</a></li>
<li><a href="#m5_functions_2">3.10. Functions</a>
<ul class="sectlevel3">
<li><a href="#m5_parameters">3.10.1. Parameters</a></li>
<li><a href="#m5_when_to_use_what_type_of_parameter">3.10.2. When To Use What Type of Parameter</a></li>
<li><a href="#fn_arguments">3.10.3. Function Call Arguments</a></li>
<li><a href="#m5_function_arguments_example">3.10.4. Function Arguments Example</a></li>
<li><a href="#m5_aftermath">3.10.5. Aftermath</a></li>
<li><a href="#m5_passing_arguments_by_reference">3.10.6. Passing Arguments by Reference</a></li>
<li><a href="#returning_status">3.10.7. Returning Status</a></li>
<li><a href="#body_arguments">3.10.8. Functions with Body Arguments</a></li>
<li><a href="#m5_tail_recursion">3.10.9. Tail Recursion</a></li>
</ul>
</li>
<li><a href="#m5_block_labels">3.11. Block Labels</a></li>
<li><a href="#m5_string_labels">3.12. String Labels</a></li>
<li><a href="#m5_syntax_configuration">3.13. Syntax Configuration</a></li>
</ul>
</li>
<li><a href="#m5_writing_tilde_code">4. Writing Tilde Code</a>
<ul class="sectlevel2">
<li><a href="#m5_code_formatting">4.1. Code Formatting</a></li>
<li><a href="#m5_unquoted_character_restrictions">4.2. Unquoted Character Restrictions</a>
<ul class="sectlevel3">
<li><a href="#m5_unquoted_argument_characters">4.2.1. Unquoted Argument Characters</a></li>
<li><a href="#m5_unquoted_arithmetic_expressions_characters">4.2.2. Unquoted Arithmetic Expressions Characters</a></li>
</ul>
</li>
<li><a href="#m5_constructing_code">4.3. Constructing Code</a></li>
</ul>
</li>
<li><a href="#m5_standard_library_reference">5. Standard Library Reference</a>
<ul class="sectlevel2">
<li><a href="#m5_coding_paradigms_patterns_tips_tricks_and_gotchas">5.1. Coding Paradigms, Patterns, Tips, Tricks, and Gotchas</a>
<ul class="sectlevel3">
<li><a href="#masking">5.1.1. Variable Masking</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#m5_macro_library">6. Macro Library</a>
<ul class="sectlevel2">
<li><a href="#m5_specification_conventions">6.1. Specification Conventions</a></li>
<li><a href="#m5_assigning_and_accessing_macrosvariables">6.2. Assigning and Accessing Macros/Variables</a>
<ul class="sectlevel3">
<li><a href="#m5_declaringsetting_variables">6.2.1. Declaring/Setting Variables</a></li>
<li><a href="#m5_declaring_macros_2">6.2.2. Declaring Macros</a></li>
<li><a href="#m5_accessing_macrovariable_values">6.2.3. Accessing Macro/Variable Values</a></li>
</ul>
</li>
<li><a href="#m5_code_constructs">6.3. Code Constructs</a>
<ul class="sectlevel3">
<li><a href="#m5_status_2">6.3.1. Status</a></li>
<li><a href="#m5_conditionals">6.3.2. Conditionals</a></li>
<li><a href="#m5_loops">6.3.3. Loops</a></li>
<li><a href="#m5_recursion_2">6.3.4. Recursion</a></li>
</ul>
</li>
<li><a href="#m5_working_with_strings">6.4. Working with Strings</a>
<ul class="sectlevel3">
<li><a href="#m5_special_characters">6.4.1. Special Characters</a></li>
<li><a href="#m5_slicing_and_dicing_strings">6.4.2. Slicing and Dicing Strings</a></li>
<li><a href="#m5_formatting_strings">6.4.3. Formatting Strings</a></li>
<li><a href="#m5_inspecting_strings">6.4.4. Inspecting Strings</a></li>
<li><a href="#m5_safely_working_with_strings">6.4.5. Safely Working with Strings</a></li>
<li><a href="#m5_regular_expressions">6.4.6. Regular Expressions</a></li>
</ul>
</li>
<li><a href="#m5_utilities">6.5. Utilities</a>
<ul class="sectlevel3">
<li><a href="#m5_fundamental_macros">6.5.1. Fundamental Macros</a></li>
<li><a href="#m5_manipulating_macro_stacks">6.5.2. Manipulating Macro Stacks</a></li>
<li><a href="#m5_argument_processing">6.5.3. Argument Processing</a></li>
<li><a href="#m5_arithmetic_macros">6.5.4. Arithmetic Macros</a></li>
<li><a href="#m5_boolean_macros">6.5.5. Boolean Macros</a></li>
<li><a href="#m5_within_functions_or_code_blocks">6.5.6. Within Functions or Code Blocks</a></li>
</ul>
</li>
<li><a href="#m5_checking_and_debugging">6.6. Checking and Debugging</a>
<ul class="sectlevel3">
<li><a href="#m5_checking_and_reporting_to_stderr">6.6.1. Checking and Reporting to STDERR</a></li>
<li><a href="#m5_uncategorized_debug_macros">6.6.2. Uncategorized Debug Macros</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#m5_reference_card">7. Reference Card</a></li>
<li><a href="#m5_index">Index</a></li>
</ul>
</div>
</div>
</div>
<div class="sect1">
<h2 id="m5_background_information">1. Background Information</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="m5_overview">1.1. Overview</h3>
<div class="paragraph">
<p>Tilde is a macro preprocessor on steroids. It is built on the simple principle of text substitution but provides features and syntax on par with other simple programming languages. It is an easy and capable tack-on enhancement to any text format as well as a reasonable general-purpose programming language specializing in text processing. Its broad applicability makes Tilde a valuable tool in every programmer/engineer/scientist/AI&#8217;s toolbelt.</p>
</div>
<div class="paragraph">
<p>This chapter provides background and general information about the Tilde language and tool and
guidance about this specification.</p>
</div>
</div>
<div class="sect2">
<h3 id="m5_about_this_specification">1.2. About this Specification</h3>
<div class="paragraph">
<p>This document covers the Tilde language as well as its standard <a href="#m5_macro_library">Macro Library</a>. This document&#8217;s major
version reflects the language version, and the minor version reflects the library version. There is
also a document subversion distinguishing versions of this document with no corresponding language or
library changes.</p>
</div>
<div class="paragraph">
<p>To target different users, this document contains the following sections:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><a href="#m5_background_information">Background Information</a></p>
</li>
<li>
<p><a href="#usage">Getting Started with the Tilde Tool</a></p>
</li>
<li>
<p><a href="#m5_reading_tilde_code">Reading Tilde Code</a></p>
</li>
<li>
<p><a href="#m5_writing_tilde_code">Writing Tilde Code</a></p>
</li>
<li>
<p><a href="#m5_standard_library_reference">Standard Library Reference</a></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>To use Tilde on an existing Tilde file, you only need to read <a href="#usage">Getting Started with the Tilde Tool</a>.</p>
</div>
<div class="paragraph">
<p>To understand a file that uses Tilde, you only need to read the <a href="#m5_reading_tilde_code">Reading Tilde Code</a> and
consult the <a href="#m5_standard_library_reference">Standard Library Reference</a> as needed.</p>
</div>
<div class="paragraph">
<p>To write Tilde code, you need to read the <a href="#m5_writing_tilde_code">Writing Tilde Code</a> section as well and become generally
familiar with the <a href="#m5_standard_library_reference">Standard Library Reference</a>.</p>
</div>
<div class="paragraph">
<p>This <a href="#m5_background_information">Background Information</a> section is optional for everyone.</p>
</div>
</div>
<div class="sect2">
<h3 id="m5_an_overview_of_tilde_concepts">1.3. An Overview of Tilde Concepts</h3>
<div class="paragraph">
<p>Tilde is built to enhance, not replace, any programming language, text format, or even plain-text file.
Tilde aims to be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>non-meddlesome, avoiding any syntax that could conflict with a target language</p>
</li>
<li>
<p>easy to learn to write, and even easier to read</p>
</li>
<li>
<p>capable (not optimal) as a general-purpose language (within the realm of text processing)</p>
</li>
<li>
<p>enabling of custom embedded syntaxes</p>
</li>
<li>
<p>easy to debug (potentially&#8212;&#8203;debugging tools are not yet available)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Tilde may execute shell commands and can thus be used as a scripting language.</p>
</div>
<div class="paragraph">
<p>Libraries are included by URI (URL or local file) and may be cached locally. Thus no library
installation or package manager is required.</p>
</div>
<div class="paragraph">
<p>There are only two data types: text and code. Code is to be evaluated. Text may
be formatted to represent other data types. For example, a function may produce an
"integer" value, meaning it produces a string containing the decimal representation of
an integer value.</p>
</div>
<div class="paragraph">
<p>Multiline strings are easily expressed using indentation to avoid the need for escape characters.
Multiline strings are a great way to make unrestricted embedded formats.</p>
</div>
<div class="paragraph">
<p>"Variables" typically hold text string values, and "macros" (most of which are "functions") hold code. Variables and functions
are global name/value pairs, though each name can hold a stack of values, with the top value being
active. These stacks are used to provide scoped variables/macros.</p>
</div>
<div class="paragraph">
<p>Macros have ordered and (generally) named parameters. They evaluate to strings. The macro
body is code that contains a series of: literal text strings, variable instantiations, arithmetic
expressions, and macro calls. Each may append to the output of the function
or assign/push/pop variables/macros.</p>
</div>
</div>
<div class="sect2">
<h3 id="m5_use_models">1.4. Use Models</h3>
<div class="paragraph">
<p>Tilde can be enabled on any source file in your project. For example, in a Make-based build
flow, add this to your Makefile:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>%: %~
  tilde $&lt; &gt; $@</pre>
</div>
</div>
<div class="paragraph">
<p>To then enable Tilde on any specific source file, simply rename the file with a trailing <code>~</code>.</p>
</div>
<div class="paragraph">
<p>Tilde can also be used to define parameterized web files. A webserver can be configured to serve
parameterized files using Tilde (similar to PHP). For example,
<code><a href="http://example.com/index.html?foo=bar" class="bare">http://example.com/index.html?foo=bar</a></code> can invoke Tilde on <code>index.html~</code> with a Tilde variable <code>foo</code>
set to <code>bar</code> that is used to configure <code>index.html~</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="m5_tildes_origin_story">1.5. Tilde&#8217;s Origin Story</h3>
<div class="paragraph">
<p>I created Tilde as a preprocessor for the <a href="https://tl-x.org">TL-Verilog</a> hardware
language and later decoupled it as a stand-alone tool. The original intent was to use
an out-of-the box macro preprocessor to provide a stop-gap solutions to missing TL-Verilog language
features for "code construction" as TL-Verilog took shape. While other hardware languages build on existing
programming languages to provide code construction, I wanted a simpler approach that would be less
intimidating to hardware folks. M4 was the obvious choice as the most broadly adopted macro preprocessor.</p>
</div>
<div class="paragraph">
<p>M4 proved to be capable, but extremely difficult to work with. After a few years
fighting with an approach that was intended to allow me to focus my attention elsewhere, I
decided I needed to either find a different approach or clean up the one I had. I felt my struggles
had led to some worthwhile insights and that there was a place in the
world for a better text processing language/tool, so I carved out some time to polish my mountain of hacks.</p>
</div>
<div class="paragraph">
<p>Though Tilde would benefit from a fresh non-M4/Perl-based implementation, I had to draw the line somewhere.
At this point, that legacy is mostly behind the scenes, and while it&#8217;s not everything I&#8217;d like it to be,
it&#8217;s close, and it&#8217;s way better than any other text preprocessor I&#8217;m aware of.</p>
</div>
<div class="paragraph">
<p>So I hope you enjoy the language I never wanted to write. I&#8217;m actually rather proud of it and find new uses
for it every day.</p>
</div>
</div>
<div class="sect2">
<h3 id="vs_m4">1.6. Tilde Versus M4</h3>
<div class="paragraph">
<p>Tilde uses M4 to implement a text-preprocessing language with some subtle philosophical
differences. Tilde aims to preserve most of the conceptual simplicity of
macro preprocessing while adding features that improve readability, manageability, and
debuggability for more complex use cases.</p>
</div>
<div class="paragraph">
<p>This document is intended to stand on its own, independent of the
<a href="https://www.gnu.org/software/m4/">M4 documentation</a>. The M4 documentation
can, in fact, be confusing due to Tilde&#8217;s philosophical differences with M4.</p>
</div>
<div class="paragraph">
<p>Beyond M4, Tilde contributes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>features that feel like a typical, simple programming language</p>
</li>
<li>
<p>literal string variables</p>
</li>
<li>
<p>functions with named parameters</p>
</li>
<li>
<p>variable/macro scope</p>
</li>
<li>
<p>an intentionally minimal amount of syntactic sugar</p>
</li>
<li>
<p>document generation assistance</p>
</li>
<li>
<p>debug aids such as stack traces</p>
</li>
<li>
<p>safer parsing and string manipulation</p>
</li>
<li>
<p>a richer core library of utilities</p>
</li>
<li>
<p>a future plan for modular libraries</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="m5_limitations_of_tilde">1.7. Limitations of Tilde</h3>
<div class="paragraph">
<p>M4 has certain limitations that Tilde is unable to address without a re-implementation that is
not based on M4 or modifications to M4 itself.</p>
</div>
<div class="sect3">
<h4 id="m5_security">1.7.1. Security</h4>
<div class="paragraph">
<p>M4 has full access to its host environment (similar to most programming and scripting
languages, but unlike many macro preprocessors). Malware can easily do harm. Third-
party Tilde code should be carefully vetted before use, or Tilde should be run within a contained
environment. Tilde provides a simple mechanism for library inclusion by URL (or it will).
This enables easy execution of public third-party code, so use it with extreme caution.</p>
</div>
</div>
<div class="sect3">
<h4 id="m5_modularity">1.7.2. Modularity</h4>
<div class="paragraph">
<p>M4 does not provide any library, namespace, and version management facilities.
Though Tilde does not currently address these needs, plans have been sketched in code comments.</p>
</div>
</div>
<div class="sect3">
<h4 id="m5_string_processing">1.7.3. String processing</h4>
<div class="paragraph">
<p>While macro processing is all about string processing, safely manipulating arbitrary
strings is not possible in M4 or it is beyond awkward at best. M4 provides
<code>m4_regexp</code>, <code>m4_patsubst</code>, and <code>m4_substr</code>. These return unquoted strings that will
necessarily be elaborated, potentially altering the string. While Tilde is able to jump
through hoops to provide <a href="#m_regex"><code>regex(&#8230;&#8203;)</code></a> and <a href="#m_substr"><code>substr(&#8230;&#8203;)</code></a> (for strings of limited length)
that return quoted (literal) text, <code>m4_patsubst</code> cannot be fixed (though <a href="#m_for_each_regex"><code>for_each_regex(&#8230;&#8203;)</code></a>
is similar). The result of <code>m4_patsubst</code> can be quoted only by quoting the input string,
which can complicate the match expression, or by ensuring that all text is matched,
which can be awkward, and quoting substitutions.</p>
</div>
<div class="paragraph">
<p>In addition to these issues, care must be taken to ensure that resulting text does not contain mismatching
quotes or parentheses or combine with surrounding text to result in the same. Such
resulting mismatches are difficult to debug. Tilde provides a notion of "unquoted strings"
that can be safely manipulated using <a href="#m_regex"><code>regex(&#8230;&#8203;)</code></a>, and <a href="#m_substr"><code>substr(&#8230;&#8203;)</code></a>.</p>
</div>
<div class="paragraph">
<p>Additionally the regex configuration used by M4 is quite dated. For example, it does
not support lookahead, lazy matches, and character codes.</p>
</div>
</div>
<div class="sect3">
<h4 id="m5_introspection">1.7.4. Introspection</h4>
<div class="paragraph">
<p>Introspection is essentially impossible. The only way to see what is defined is to
dump definitions to a file and parse this file.</p>
</div>
</div>
<div class="sect3">
<h4 id="m5_recursion">1.7.5. Recursion</h4>
<div class="paragraph">
<p>Recursion has a fixed (command-line) depth limit, and this limit is not applied reliably.</p>
</div>
</div>
<div class="sect3">
<h4 id="m5_unicode">1.7.6. Unicode</h4>
<div class="paragraph">
<p>M4 is an old tool and was built for ASCII text. UTF-8 is now the most common text format.
It is a superset of ASCII that encodes additional characters as two or more bytes using byte
codes (0x10-0xFF) that do not conflict by those defined by ASCII (0x00-0x7F). All such bytes
(0x10-0xFF) are treated as characters by M4 with no special meaning, so these characters
pass through, unaffected, in macro processing like most others. There are two
implications to be aware of. First, <a href="#m_length"><code>length(&#8230;&#8203;)</code></a> provides a length in bytes, not characters.
Second, <a href="#m_substr"><code>substr(&#8230;&#8203;)</code></a> and regular expressions manipulate bytes, not characters. This can
result in text being split in the mid-character, resulting in invalid character
encodings.</p>
</div>
</div>
<div class="sect3">
<h4 id="m5_debugging_features">1.7.7. Debugging features</h4>
<div class="paragraph">
<p>M4&#8217;s facilities for associating output with input only map output lines to line numbers of
top-level calls. M4 does not maintain a call stack with line numbers.</p>
</div>
<div class="paragraph">
<p>M4 and Tilde have no debugger to step through code. Printing (see <a href="#m_DEBUG"><code>DEBUG(&#8230;&#8203;)</code></a> is the debugging mechanism of choice.</p>
</div>
</div>
<div class="sect3">
<h4 id="m5_performance">1.7.8. Performance</h4>
<div class="paragraph">
<p>Tilde is intended for text processing, not for compute-intensive algorithms. Use a programming
language for that.</p>
</div>
</div>
<div class="sect3">
<h4 id="m5_graphics">1.7.9. Graphics</h4>
<div class="paragraph">
<p>Tilde is for text processing only.</p>
</div>
</div>
<div class="sect3">
<h4 id="m5_status">1.7.10. Status</h4>
<div class="paragraph">
<p>This specification documents intended language syntax prior to a clean re-implementation.
Stay tuned.</p>
</div>
<div class="paragraph">
<p>Major next steps include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Implementing a better library system.</p>
</li>
<li>
<p>Some syntactic sugar (quotes, code blocks) should not be recognized in source context.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>See issues file in the <a href="https://github.com/rweda/M5">M5 repository</a> for more details.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="usage">2. Getting Started with the Tilde Tool</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="config">2.1. Configuring Tilde</h3>
<div class="paragraph">
<p>Tilde adds a minimal amount of syntax, and it is important that this syntax is unlikely to conflict
with the target language syntax. The syntax that could conflict is listed in <a href="#m5_ensure_no_impact">Ensure No Impact</a>.
Currently, there is no easy mechanisms to configure this syntax.</p>
</div>
</div>
<div class="sect2">
<h3 id="m5_running_tilde">2.2. Running Tilde</h3>
<div class="paragraph">
<p>The Linux command:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="highlight"><code class="language-sh" data-lang="sh">tilde in-file &gt; out-file</code></pre>
</div>
</div>
<div class="paragraph">
<p>runs Tilde in its default configuration.</p>
</div>
<div class="paragraph">
<p>(Currently, there&#8217;s a dependency on M4 and perl and no installation script.)</p>
</div>
</div>
<div class="sect2">
<h3 id="m5_ensure_no_impact">2.3. Ensure No Impact</h3>
<div class="paragraph">
<p>When enabling the use of Tilde on a file, first, be sure Tilde processing does nothing to the file.
Tilde should output the input text, unaltered, as long as your file contains no:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>&lt;"&gt;</code></p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="m5_tool_flow">2.4. Tool Flow</h3>
<div class="paragraph">
<p>Since Tilde is simply substituting text, you can do bizarre things, which can be difficult to debug.
Understanding the tool flow can help you look one step under the hood to debug issues or understand
how syntax is interpreted.</p>
</div>
<div class="paragraph">
<p>Tilde basically processes files in two steps:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Interpret syntactic sugar.</p>
</li>
<li>
<p>Run M4.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>(There is a third step as well that is very minor to undo some of the sugaring.)</p>
</div>
<div class="paragraph">
<p>Object files are generated (run <code>tilde -h</code> for options) that expose the interpretation of Tilde sugar.
Note that quotes and commas are substituted with control characters in these files, so you will
need an appropriate tool to view them. Your shell may recognize them as binary files and prompt you
about viewing them, which is fine to do.</p>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="m5_reading_tilde_code">3. Reading Tilde Code</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="m5_a_quick_overview_by_example">3.1. A Quick Overview by Example</h3>
<div class="paragraph">
<p>The following example gives a general view of typical Tilde code and provides context for describing
its language features. This example defines a "macro" called <code>withdraw</code> that updates a <code>Balance</code> variable
(referenced as <code>$Balance</code>) and returns text describing the transaction. It should be fairly readable
even without knowledge of Tilde syntax.</p>
</div>
<div class="literalblock">
<div class="content">
<pre># Withdraw credits from $Balance.
# Args:
#   Amount: The number of credits to withdraw.
# Side Effects:
#   Updates $Balance.
# Output:
#   Text describing the transaction.
#   E.g.:
#     Withdrawing 40.
#     Starting balance: 100.
#     New balance: 60.
macro(withdraw, Amount, {
   # Report the transaction and balance.
   "Withdrawing " $Amount "." |     # Note: "|" produces a newline.
   "Starting balance: " $Balance "." |
   if([$Balance &gt;= $Amount], {
      # Make/report the withdrawal.
      decrement(Balance, $Amount)
      "New balance: " $Balance "." |
   }, {
      # No withdrawal.
      "Insufficient balance." |
   })
})</pre>
</div>
</div>
<div class="paragraph">
<p>This macro is called below:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>var(Balance, 100)   # Declare variable $Balance with value 100.
withdraw(40)        # Withdraw 40 from $Balance.</pre>
</div>
</div>
<div class="paragraph">
<p>and produces the text:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Withdrawing 40.
Starting balance: 100.
New balance: 60.</pre>
</div>
</div>
<div class="paragraph">
<p>Macro arguments are supplied as "code"--a sequence of "statements", with optional whitespace
separation, where statements may be:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Literal strings, e.g. <code>"Withdrawing "</code> and <code>Balance</code></p>
</li>
<li>
<p>Variable instantiations, e.g. <code>$Amount</code></p>
</li>
<li>
<p>Arithmetic expressions: e.g. <code>[Balance &gt;= $Amount]</code></p>
</li>
<li>
<p>Macros calls: e.g. <code>var(Balance, 100)</code></p>
</li>
<li>
<p>Special syntax: e.g. <code>|</code> for newline</p>
</li>
<li>
<p>Code blocks: i.e. <code>{&#8230;&#8203;}</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Aside from code blocks, each of these produces (possibly empty) text, and the result of evaluating the code
is the concatenation of this text.</p>
</div>
<div class="paragraph">
<p>A macro argument can be as simple as a literal string or as complex as
a function body. For example, the code above calls <code>macro</code> with three arguments as <code>macro(withdraw, Amount, {&#8230;&#8203;})</code>. The first
two arguments are unquoted strings (aka "tokens"), and the third is the entire body of the <code>withdraw</code>
macro.</p>
</div>
<div class="paragraph">
<p>When calling a macro, the code of each argument is evaluated, and the resulting strings are passed
into the parameters. For an argument that is enclosed in <code>{</code>/<code>}</code>, the parameter becomes the code itself,
and this code may be evaluated later. The arguments to the <code>if</code> macro call above, for example, include
two code arguments, and the <code>if</code> macro evaluates one of them.</p>
</div>
<div class="paragraph">
<p>The remainder of this section describes these language features in greater detail using their default
syntax. Note that some syntax is configurable. See <a href="#m5_syntax_configuration">Syntax Configuration</a>.</p>
</div>
</div>
<div class="sect2">
<h3 id="m5_literal_strings">3.2. Literal Strings</h3>
<div class="sect3">
<h4 id="m5_quoted_literal_strings">3.2.1. Quoted Literal Strings</h4>
<div class="paragraph">
<p>There are two syntaxes for quoted literal strings:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>"</code>/<code>"</code>: Light quotes. These are used for literal text strings.</p>
</li>
<li>
<p><code>&lt;"&gt;</code>/<code>&lt;"&gt;</code>: Heavy quotes. These are also used for literal text strings and are
generally used for larger, often multiline text.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Heavily quoted strings differ from lightly quoted strings only in the quote characters used.
Heavy quotes reduce the likelihood of conflicts with end quote characters in the strings.</p>
</div>
<div class="paragraph">
<p>The only characters with special (non-literal) meaning within the string are the corresponding end
quote characters. If the end quote characters are needed literally in the string, they can be followed
by a <code>~</code> character. The <code>~</code> will be dropped and the string will continue until a non-literal
end quote is encountered. Thus:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>"Say, "~Cheese"~!"</pre>
</div>
</div>
<div class="paragraph">
<p>represents the string: <code>Say, "Cheese"!</code>. Alternatively, heavy quotes can be used to avoid
the need for the literal (<code>~</code>) character:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>&lt;"&gt;Say, "~Cheese"!&lt;"&gt;</pre>
</div>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
Most languages use an escape character that precedes, not follows, the character to be escaped.
Such a prefix escape character would itself need to have an escape sequence. Using a postfix character
avoids this need. Other escape scenarios are handled in Tilde by ending the string and
starting a new one later, which is concatenated, e.g.: <code>"Hi, "$Name"!"</code>.
</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="m5_unquoted_literal_characters">3.2.2. Unquoted Literal Characters</h4>
<div class="paragraph">
<p>Argument characters that have no special meaning may pass through to a macro parameter literally.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>var(Player.1.Score, 0)</pre>
</div>
</div>
<div class="paragraph">
<p>is equivalent to:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>var("Player.1.Score", "0")</pre>
</div>
</div>
<div class="paragraph">
<p>For details on which characters are permitted without quotes, see <a href="#m5_unquoted_character_restrictions">Unquoted Character Restrictions</a>.</p>
</div>
</div>
<div class="sect3">
<h4 id="m5_multiline_strings">3.2.3. Multiline Strings</h4>
<div class="paragraph">
<p>Multiline strings begin with light or heavy quotes (<code>"</code> or <code>&lt;"&gt;</code>) that are followed immediately by a newline.
The string is indented beneath the line containing the begin quote. It is terminated by
the corresponding close quote beginning a line at the same level of indentation as the line on which
the string began. The string&#8217;s indentation, as well as the initial and final newline are excluded from
the string. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>set(MyPythonCode, &lt;"&gt;
  def foo():
    print("Hello, world!")
&lt;"&gt;)</pre>
</div>
</div>
<div class="paragraph">
<p>The indentation is determined by the first non-whitespace character of the string.
To enable multiline strings that begin with whitespace, a line containing only <code>v</code>
can be used to point to the first character of the string. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>set(MyPythonCode, &lt;"&gt;
  v
    def foo():
      print("Hello, world!")
&lt;"&gt;)</pre>
</div>
</div>
<div class="paragraph">
<p>Defines a similar string with two spaces of indentation.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="m5_arithmetic_expressions">3.3. Arithmetic Expressions</h3>
<div class="paragraph">
<p>Arithmetic expressions can be provided within <code>[</code>/<code>]</code> and cannot be immediately preceded
by word characters.</p>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>var(Val, [1 + 2 * 3])
$Val    # Yields: "7"</pre>
</div>
</div>
<div class="paragraph">
<p><code>[1 + 2 * 3]</code> is essentially shorthand syntax for <code>calc(1+2*3)</code>. (See <a href="#m_calc"><code>calc(&#8230;&#8203;)</code></a>.)</p>
</div>
<div class="paragraph">
<p>Like other macro argument text, the text of the expression is code that evaluates to a string.
The string, in this case, must be a valid expression as defined by <a href="#m_calc"><code>calc(&#8230;&#8203;)</code></a>. The example below
illustrates that expressions may contain subexpressions, variable instantiations, macro calls,
and unquoted characters.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>var(Val, [[$Val + 1] * if($Negate, -1, 1)])</pre>
</div>
</div>
<div class="paragraph">
<p>The set of characters that may be unquoted is different for expressions than for macro arguments.
(See <a href="#Argument Text">[Argument Text]</a>.)</p>
</div>
</div>
<div class="sect2">
<h3 id="variables">3.4. Variables</h3>
<div class="paragraph">
<p>Variables are name/value pairs where each may be an arbitrary string. Values may also be
code. (See <a href="#Code">[Code]</a>.)</p>
</div>
<div class="paragraph">
<p>Variables are global, though each can hold a stack of values, with the top value being
active. These stacks are used to provide scoped variables.</p>
</div>
<div class="paragraph">
<p>Tilde does not specifically support data structures, but these can be implemented by libraries.
For example, the variable <code>Player.1.Score</code> might represent a field <code>Score</code> of entry <code>1</code> of
the <code>Player</code> array.</p>
</div>
<div class="paragraph">
<p>Variables are defined (or pushed to their stack) using: <a href="#m_var"><code>var(&#8230;&#8203;)</code></a>, are reassigned using <a href="#m_set"><code>set(&#8230;&#8203;)</code></a>,
and are accessed using <a href="#m_get"><code>get(&#8230;&#8203;)</code></a>. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>var(Foo, 5)
increment(Foo)
get(Foo)</pre>
</div>
</div>
<div class="paragraph">
<p>The syntax <code>$Foo</code> is shorthand for <code>get(Foo)</code>. Thus:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>$Foo</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="m5_macro_calls">3.5. Macro Calls</h3>
<div class="paragraph">
<p>The following illustrates a call of the macro named <code>foo</code>:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>foo(hello, 5)</pre>
</div>
</div>
<div class="paragraph">
<p>A well-formed macro name is comprised of one or more word characters
(<code>a-z</code>, <code>A-Z</code>, <code>0-9</code>, and <code>_</code>). Though discouraged, it is possible to define macros with names containing non-word characters.
Such macros can only be called indirectly, e.g. <code>call("b@d", args)</code>. (See <a href="#m_call"><code>call(&#8230;&#8203;)</code></a>.)</p>
</div>
<div class="paragraph">
<p>The text string for an argument, between <code>(</code>, <code>,</code>, and/or <code>)</code>, is code or a code block. (See <a href="#Code">[Code]</a>.)</p>
</div>
<div class="paragraph">
<p>Empty argument text, as in <code>foo(, )</code>, is not permitted. Empty argument values are typically provided as <code>""</code>,
thus <code>foo("", "")</code> is legal syntax. <code>foo()</code> represents a zero-argument call, not a call with a single empty argument.</p>
</div>
</div>
<div class="sect2">
<h3 id="m5_code_blocks">3.6. Code Blocks</h3>
<div class="paragraph">
<p>Code blocks are code enclosed in <code>{</code>/<code>}</code>. They capture code for future evaluation.</p>
</div>
<div class="paragraph">
<p>A code block can be evaluated (to a string) using the <a href="#m_eval"><code>eval(&#8230;&#8203;)</code></a> macro. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>eval({set(Foo, 5)})</pre>
</div>
</div>
<div class="paragraph">
<p>Has the same effect as:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>set(Foo, 5)</pre>
</div>
</div>
<div class="paragraph">
<p>The <a href="#m_if"><code>if(&#8230;&#8203;)</code></a> macro, below, has a first argument that is a condition and second
and third arguments that may be evaluated (using <a href="#m_eval"><code>eval(&#8230;&#8203;)</code></a>) depending on the value
of the condition. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>if($Okay, {doit()}, {error("Bad.")})</pre>
</div>
</div>
<div class="paragraph">
<p>If <a href="#m_eval"><code>eval(&#8230;&#8203;)</code></a> is given a string rather than a code block, it simply returns the string.
Thus a macro argument that is to be evaluated as code may generally also be given without <code>{</code>/<code>}</code>
to pre-evaluate the code. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DEBUG("BoolVar is " if($BoolVar, {"true"}, {"false"}) ".")</pre>
</div>
</div>
<div class="paragraph">
<p>can be simplified to:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>DEBUG("BoolVar is " if($BoolVar, "true", "false") ".")</pre>
</div>
</div>
<div class="paragraph">
<p>Generally, as above, a macro argument will either be a single code block or statements producing strings.
There are, however, no restrictions on mixing code blocks and other statements. An argument can contain
a mix of pre-evaluated strings and code blocks. Consider the following example, which iterates over
items, listing each one with leading text:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>repeat($NumItems, {$Indentation ": " GetItem($LoopCnt)})</pre>
</div>
</div>
<div class="paragraph">
<p>The first argument of the <code>repeat</code> macro is the number of iterations. The second is code to evaluate for each
iteration. <code>$LoopCnt</code> is implicitly defined by <code>repeat</code> as the loop index. In this example, <code>$Indentation ": "</code> is
the same for every iteration and can be pre-evaluated. We can achieve this as:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>repeat($NumItems, {} $Indentation ": " {GetItem($LoopCnt)})    # TODO: Is {} needed to coerce here or will coercion necessarily happen later anyway.
repeat($NumItems, {:$Indentation ": " GetItem($LoopCnt)})      # Or, code block have to be a complete argument?</pre>
</div>
</div>
<div class="paragraph">
<p>TODO: Macro has everything a function has except scope for the body. That includes aftermath and
      push/pop of parameters (popped before aftermath). Function in not
      built-in and adds scope to the body. Code block is a macro with zero args.
Nope: Calls push/pop $1&#8230;&#8203; Functions add scope and push/pop params and are built-in so $1&#8230;&#8203; can
      be assigned to &#8230;&#8203; args only. Code blocks are functions with no parameters (so there
      can be no push/pop of $1&#8230;&#8203; and no scope). Use foo() or eval(foo) to evaluate code blocks??
Nope: Macros are not built-in. Functions/code blocks are special built-in stacked variables and have text representations
      of their bodies accessible via body_of(&#8230;&#8203;). (Functions are scoped; code blocks are not.)
      {} are code quotes.
      (They can be passed as code parameters as {foo()} (deferred) or get_code(foo).)
      Macros are a library function that modifies the code to replace $1, etc.
TODO: Returning unquoted (inline) text to be evaluated, such as arg lists? Looks like I got rid of that in M5?
      Maybe comma should be allowed in a code block as an argument separator&#8212;&#8203;no, too dangerous.</p>
</div>
</div>
<div class="sect2">
<h3 id="m5_declaring_macros">3.7. Declaring Macros</h3>
<div class="paragraph">
<p>Macros are in some respects, like variables. While variables can only be assigned to strings,
macros are assigned to code. Unlike variables, macros take parameters. Though macros are
rarely defined to be scoped, they can be and they have stacks, like variables.</p>
</div>
<div class="paragraph">
<p>Macros declarations take the form:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>macro(&lt;name&gt;, [&lt;param-list&gt;,] {&lt;body&gt;})</pre>
</div>
</div>
<div class="paragraph">
<p>For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>macro(hello, Name, {"Hello, " $Name "!"})</pre>
</div>
</div>
<div class="paragraph">
<p>defines a macro named <code>Hello</code> that takes a parameter <code>Name</code>. This macro can be instantiated as:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>hello("Joe")</pre>
</div>
</div>
<div class="paragraph">
<p>resulting in the string: <code>Hello, Joe!</code>.</p>
</div>
</div>
<div class="sect2">
<h3 id="m5_special_code_syntax">3.8. Special Code Syntax</h3>
<div class="paragraph">
<p><code>|</code> is shorthand for <a href="#m_nl"><code>nl()</code></a> and produces a newline.</p>
</div>
<div class="paragraph">
<p><code>~</code> is used to force preceding end quote characters to be taken literally and to continue a string.</p>
</div>
<div class="paragraph">
<p>code(CallBarABC, {call(bar(a, b, c))})
CallBarABC()  # bar(a, b, c)
code_var(MyArgs, {, 1, 2, 3})   # Code may start with "," and, if it does, it may contain other top-level commas.
args_code(MyArgs, 1, 2, 3)  # Equivalent to the above.
append_code(MyArgs, {, 4})
with_args({args_var(NewArgs, arg(1) args(3..))}, MyArgs)   # var(NewArgs, {, 1, 3, 4})
args_var(MyArgs, ", 1, 2, 3")   # Must be empty or begin with ","; legal, balanced code delimited by ",".
                                # Only code_snippet can take incomplete code arg.
call(MyFn MyArgs())   # MyFn(1, 2, 3)
code(CallFoo, to_code("call(foo" $MyArgs ")"))
CallFoo()  # foo(1, 2, 3)
call(arg(0), shift(2))   # args(3..) == shift(2)</p>
</div>
<div class="paragraph">
<p>Somewhere&#8230;&#8203; a code block that represents one or more arguments must begin with <code>,</code>. An empty code
block may represent zero arguments.</p>
</div>
<div class="paragraph">
<p><code>@</code> begins a reference to zero or more numbered parameters. A reference to a negative number of
parameters results in an error. Some syntaxes refer specifically to one parameter. These may
appear anywhere in the code, thus they may contribute to part of an argument. Syntaxes which may
refer to multiple parameters must produce a discrete number of arguments must be placed where
an argument would be placed, preceded and followed by argument delimitation: <code>,</code>/<code>(</code> and <code>,</code>/<code>)</code>
or in a code block which will begin with <code>,</code>. Though it appears as as an argument, it may result in
zero arguments, where a preceding or following comma is ignored, or, if delimited by <code>(</code>/<code>)</code>, it
may result in zero arguments.</p>
</div>
<div class="paragraph">
<p><code>@1</code> refers to the first unnamed parameter (which must exist), <code>@15</code> the 15th.</p>
</div>
<div class="paragraph">
<p><code>@2?</code> refers to the second unnamed parameter or "" if it doesn&#8217;t exist.</p>
</div>
<div class="paragraph">
<p><code>@3..</code> refers to all arguments from the third, or none, in which case the preceding <code>,</code> is ignored.</p>
</div>
<div class="paragraph">
<p><code>@1..3</code> is equivalent to <code>@1, @2, @3</code>.</p>
</div>
<div class="paragraph">
<p><code>@1..3?</code> is equivalent to <code>@1?, @2?, @3?</code>.</p>
</div>
<div class="paragraph">
<p><code>@1..-1</code> is arguments @1 up to the one before the last.</p>
</div>
<div class="paragraph">
<p><code>@(&#8230;&#8203;)</code> evaluates the parenthetical code and interprets the results as the text after <code>@</code> in cases above.</p>
</div>
<div class="paragraph">
<p><code>@foo(&#8230;&#8203;)</code> evaluates the resulting code, which must begin with a comma argument separator or be empty.
This comma will be ignored or an empty result represents zero arguments.</p>
</div>
<div class="paragraph">
<p><code>@#</code> is the number of arguments.</p>
</div>
</div>
<div class="sect2">
<h3 id="m5_functions">3.9. Functions</h3>
<div class="paragraph">
<p>Functions are macros that evaluate in their own scope.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>fn()</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="m5_functions_2">3.10. Functions</h3>
<div class="paragraph">
<p>All but the simplest of macros are most often declared using <code>m5_fn</code> and similar macros. These support a richer set of
mechanisms for defining and passing parameter. While <code>m5_macro</code> is most often used with a one-line body definition,
<code>m5_fn</code> is most often used with multi-line bodies as <a href="#Scoped Code Blocks">[Scoped Code Blocks]</a>.</p>
</div>
<div class="paragraph">
<p>Such <code>m5_fn</code> declarations using <a href="#Scoped Code Blocks">[Scoped Code Blocks]</a> look and act like functions/procedures/subroutines/methods in a traditional
programming language, and we often refer to them as "functions". Function calls pass arguments into parameters. Functions'
code block bodies contain macro calls (statements) that define local variables, perform calculations, evaluate code conditionally,
iterate in loops, call other functions, recurse, etc.</p>
</div>
<div class="paragraph">
<p>Unlike typical programming languages, functions, like all macros, evaluate to text that substitutes for the calls.
There is no mechanism to explicitly print to the standard output stream (though there
are macros for printing to the standard error stream). Only a top-level call from the source code will
implicitly echo to standard output.</p>
</div>
<div class="paragraph">
<p>Functions are defined using: <a href="#m_fn"><code>fn(&#8230;&#8203;)</code></a> and <a href="#m_lazy_fn"><code>lazy_fn(&#8230;&#8203;)</code></a>.</p>
</div>
<div class="paragraph">
<p>Declarations take the form:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>m5_fn(&lt;name&gt;, [&lt;param-list&gt;,] ['&lt;body&gt;'])</pre>
</div>
</div>
<div class="paragraph">
<p>A basic function declaration with a one-line body looks like:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>m5_fn(mul, val1, val2, ['m5_calc(m5_val1 * m5_val2)'])</pre>
</div>
</div>
<div class="paragraph">
<p>Or, equivalently, using a code block body:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>fn(mul, val1, val2, {
   ~calc(m5_val1 * m5_val2)
})</pre>
</div>
</div>
<div class="paragraph">
<p>This <code>mul</code> function is called (in source context) like:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>m5_mul(3, 5)  /// produces 15</pre>
</div>
</div>
<div class="sect3">
<h4 id="m5_parameters">3.10.1. Parameters</h4>
<div class="sect4">
<h5 id="m5_parameters_types_and_usage">3.10.1.1. Parameters Types and Usage</h5>
<div class="ulist">
<ul>
<li>
<p><strong>Numbered parameters</strong>: Numbered parameters, as in <a href="#m_macro"><code>macro(&#8230;&#8203;)</code></a> (see <a href="#m5_declaring_macros">Declaring Macros</a>), can be referenced as <code>$1</code>, <code>$2</code>, etc. with
the same replacement behavior. However, they
are explicitly identified in the parameter list (see <a href="#parameter_list">The Parameter List</a>).
Within the function body, similar to <code>['$3']</code>, <a href="#m_fn_arg"><code>fn_arg(&#8230;&#8203;)</code></a> may also be used to access an argument. For example,
<code>m5_fn_arg(3)</code> evaluates to the literal third argument value.</p>
</li>
<li>
<p><strong>Special parameters</strong>: As for <a href="#m_macro"><code>macro(&#8230;&#8203;)</code></a>, special parameters are supported. Note that: <code>$@</code>, <code>$*</code>, and <code>$#</code> reflect only
numbered parameters. Also, <code>$0</code> will not have the expected value, however <code>$0__</code> can still be
used as a name prefix to localize names to this function. (See <a href="#masking">Variable Masking</a>.) Similar to <code>$@</code>, the <a href="#m_fn_args"><code>fn_args()</code></a> macro
(or variable) also provides a quoted list of the numbered arguments.
Similar to <code>$#</code>, the <a href="#m_fn_arg_cnt"><code>fn_arg_cnt()</code></a> macro also provides the number of numbered arguments.</p>
</li>
<li>
<p><strong>Named parameters</strong>: These are available locally to the body as variables. They are not available to the <a href="#m5_aftermath">Aftermath</a> of
the function.</p>
</li>
</ul>
</div>
</div>
<div class="sect4">
<h5 id="parameter_list">3.10.1.2. The Parameter List</h5>
<div class="paragraph">
<p>The parameter list (<code>&lt;param-list&gt;</code>) is a list of zero or more <code>&lt;param-spec&gt;</code>s, where <code>&lt;param-spec&gt;</code> is:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>A parameter specification of the form: <code>[?][[&lt;number&gt;]][[^]&lt;name&gt;][: &lt;comment&gt;]</code> (in this order), e.g. <code>?[2]^Name: the name of something</code>:</p>
<div class="ulist">
<ul>
<li>
<p><code>&lt;name&gt;</code>:   Name of a named parameter.</p>
</li>
<li>
<p><code>?</code>:        Specifies that the parameter is optional. Calls are checked to ensure that arguments are provided for all non-optional parameters
or are defined for inherited parameters. Non-optional parameters may
not follow optional ones.</p>
</li>
<li>
<p><code>[&lt;number&gt;]</code>: Number of a numbered parameter. The first must be <code>[1]</code> and would correspond to <code>$1</code> and <code>m5_fn_arg(1)</code>, and so on.
<code>&lt;number&gt;</code> is verified to match the sequential ordering of numbered parameters. Numbered parameters may
also be named, in which case they can be accessed either way.</p>
</li>
<li>
<p><code>^</code>:        Specifies that the parameter is inherited. It must also be named. Its definition is inherited from the context of the func definition.
If undefined, the empty <code>['']</code> value is provided and an error is reported unless the parameter is optional,
e.g. <code>?^&lt;name&gt;</code>. There is no corresponding argument in a call of this function. It is conventional to list
inherited parameters last (before the body) to maintain correspondence between the parameter
list of the definition and the argument list of a call.</p>
</li>
<li>
<p><code>&lt;comment&gt;</code>: A description of the parameter. In addition to commenting the code, this can be extracted in
documentation.</p>
</li>
</ul>
</div>
</li>
<li>
<p><code>&#8230;&#8203;</code>:        Listed after last numbered parameter to allow extra numbered arguments. Without this, extra arguments
result in an error (except for the single empty argument of e.g. <code>m5_foo()</code>. See <a href="#fn_arguments">Function Call Arguments</a>.)</p>
</li>
</ul>
</div>
</div>
</div>
<div class="sect3">
<h4 id="m5_when_to_use_what_type_of_parameter">3.10.2. When To Use What Type of Parameter</h4>
<div class="paragraph">
<p>For nested declarations, the use of numbered parameters (<code>$1</code>, <code>$2</code>, &#8230;&#8203;) and special parameters
(<code>$@</code>, <code>$*</code>, <code>$#</code>, and <code>$0</code>) can be extremely awkward.
Nested declarations are declarations within the bodies of other declarations. Since nested bodies are part of outer bodies,
numbered and special parameters within them would actually substitute based on the outer bodies. This can be prevented
by generating the body with macros that produce the numbered parameter references, but this requires an unnatural and bug prone use of quotes.
Therefore the use of functions with named parameters is preferred for inner macro declarations. Use of <a href="#m_fn_args"><code>fn_args()</code></a> and <a href="#m_fn_arg"><code>fn_arg(&#8230;&#8203;)</code></a> is
also simpler than using special parameters. If parameters are named, these are helpful primarily
to access <code>&#8230;&#8203;</code> arguments or to pass argument lists to other functions.</p>
</div>
<div class="paragraph">
<p>Additionally, and in summary:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><strong>Numbered/special parameters</strong>: These can be convenient to ensure substitution throughout the body without interference from
quotes. They can, however, be extremely awkward to use in nested definitions
as they would substitute with the arguments of the outer function/macro. Being unnamed,
readability is an issue, especially for large functions.</p>
</li>
<li>
<p><strong>Named parameters</strong>: These act more like typical function arguments vs. text substitution. Since they are named, they
can improve readability. Unlike numbered parameters, they work perfectly well in functions
defined within other functions/macros. (Similarly, <a href="#m_fn_args"><code>fn_args()</code></a> and <a href="#m_fn_arg"><code>fn_arg(&#8230;&#8203;)</code></a> are useful
for nested declarations.) Macros will not evaluate within quoted strings, so typical use requires
unquoting, e.g. <code>['Arg1: ']m5_arg1['.']</code> vs. <code>['Arg1: $1.']</code>.</p>
</li>
<li>
<p><strong>Inherited parameters</strong>: These provide a more natural, readable, and explicit mechanism for customizing a function to the
context in which it is defined. For example a function may define another function that is
customized to the parameters of the outer function.</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="fn_arguments">3.10.3. Function Call Arguments</h4>
<div class="paragraph">
<p>Function calls must have arguments for all non-optional, non-inherited (<code>^</code>) parameters. Arguments are positional, so misaligning arguments
is a common source of errors. There is checking, however, that required arguments are provided and that no extra arguments are given.
<code>m5_foo()</code> is permitted for a function <code>foo</code> declared with no parameters, though it is passed one emtpy parameter.
(<code>m5_call(foo)</code> might be preferred.)</p>
</div>
</div>
<div class="sect3">
<h4 id="m5_function_arguments_example">3.10.4. Function Arguments Example</h4>
<div class="paragraph">
<p>In argument list context, function <code>foo</code> is declared below to display its parameters.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/Context:
var(Inherit2, two)
/Define foo:
fn(foo, Param1, ?[1]Param2: an optional parameter,
        ?^Inherit1, [2]^Inherit2, ..., {
   ~nl(Param1: m5_Param1)
   ~nl(Param2: m5_Param2)
   ~nl(Inherit1: m5_Inherit1)
   ~nl(Inherit2: m5_Inherit2)
   ~nl(['numbered args: $@'])
})</pre>
</div>
</div>
<div class="paragraph">
<p>And it can be called (again, in argument list context):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/Call foo:
foo(arg1, arg2, extra1, extra2)</pre>
</div>
</div>
<div class="paragraph">
<p>And this expands to:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>Param1: arg1
Param2: arg2
Inherit1:
Inherit2: two
numbered args: ['arg2'],['two'],['extra1'],['extra2']</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="m5_aftermath">3.10.5. Aftermath</h4>
<div class="paragraph">
<p>It is possible for a function to make assignments (and, actually do anything) in the calling scope.
This can be done using <a href="#m_on_return"><code>on_return(&#8230;&#8203;)</code></a> or <a href="#m_return_status"><code>return_status(&#8230;&#8203;)</code></a>.</p>
</div>
<div class="paragraph">
<p>This is important for:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>passing arguments by reference</p>
</li>
<li>
<p>returning status</p>
</li>
<li>
<p>evaluating body arguments</p>
</li>
<li>
<p>tail recursion</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Each of these is discussed in its own section, next.</p>
</div>
</div>
<div class="sect3">
<h4 id="m5_passing_arguments_by_reference">3.10.6. Passing Arguments by Reference</h4>
<div class="paragraph">
<p>Functions can pass variables by reference and make assignments to the referenced
variables upon returning from the function. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>fn(update, FooRef, {
   var(Value, ['updated value'])
   on_return(set, m5_FooRef, m5_Value)
}
set(Foo, ['xxx'])
update(Foo)
~Foo</pre>
</div>
</div>
<div class="paragraph">
<p>A similar function could be defined to declare a referenced variable by using <code>var</code> instead of <code>set</code>.</p>
</div>
<div class="paragraph">
<p>The use of <a href="#m_on_return"><code>on_return(&#8230;&#8203;)</code></a> avoids the potential masking issue that would result from:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>update(Value)</pre>
</div>
</div>
</div>
<div class="sect3">
<h4 id="returning_status">3.10.7. Returning Status</h4>
<div class="paragraph">
<p>A function&#8217;s <a href="#v_status"><code>$status</code></a> should be returned via the function&#8217;s aftermath, using <a href="#m_return_status"><code>return_status(&#8230;&#8203;)</code></a>, e.g.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>fn(my_fn, Val, {
   if(m5_Val &gt; 10, [''])
   return_status(m5_status)
})</pre>
</div>
</div>
<div class="paragraph">
<p>Functions automatically restore <a href="#v_status"><code>$status</code></a> after body evaluation to its value prior to body evaluation, so
the evaluation of the body has no impact on <a href="#v_status"><code>$status</code></a>. Aftermath is evaluated after this.
It is fine to call <a href="#m_return_status"><code>return_status(&#8230;&#8203;)</code></a> multiple times. Only the last call will have a visible effect.</p>
</div>
</div>
<div class="sect3">
<h4 id="body_arguments">3.10.8. Functions with Body Arguments</h4>
<div class="paragraph">
<p>The example below illustrates a function <code>if_neg</code> that takes an argument that is a body to evaluate.
The body is defined in a calling function, e.g. <code>my_fn</code> on lines 15-16. Such a body is expected to evaluate
in the context of the calling function, <code>my_fn</code>. Its assignment of <code>Neg</code>, on line 15, should be an assignment of
its own local <code>Neg</code>, declared on line 12. Its side effects from <a href="#m_return_status"><code>return_status(&#8230;&#8203;)</code></a> on
line 15 should be side effects of <code>my_fn</code>.</p>
</div>
<div class="paragraph">
<p>If the body is evaluated inside the function body, its side effects would be side effects of <code>if_neg</code>,
not <code>my_fn</code>. The body should instead be evaluated as aftermath, using <a href="#m_on_return"><code>on_return(&#8230;&#8203;)</code></a>, as on line 6.</p>
</div>
<div class="paragraph">
<p>Note that <a href="#m_return_status"><code>return_status(&#8230;&#8203;)</code></a> is called after evaluating <code>m5_Body</code>. Both <a href="#m_on_return"><code>on_return(&#8230;&#8203;)</code></a> and <a href="#m_return_status"><code>return_status(&#8230;&#8203;)</code></a>
add to the <a href="#m5_aftermath">Aftermath</a> of the function, and <a href="#v_status"><code>$status</code></a> must be set after evaluating the body (which
could affect <a href="#v_status"><code>$status</code></a>).</p>
</div>
<div class="paragraph">
<p>Example of a body argument.</p>
</div>
<div class="literalblock">
<div class="content">
<pre> 1: // Evaluate a body if a value is negative.
 2: fn(if_neg, Value, Body, {
 3:    var(Neg, m5_calc(Value &lt; 0))
 4:    ~if(Neg, [
 5:       /~eval(m5_Body)
 6:       on_return(Body)
 7:    ])
 8:    return_status(if(Neg, [''], else))
 9: })
10:
11: fn(my_fn, {
12:    var(Neg, [''])
13:    return_status(['pos'])
14:    ~if_neg(1, [
15:       return_status(['neg'])
16:       set(Neg, ['-'])
17:    ])
18:    ...
19: })</pre>
</div>
</div>
<div class="paragraph">
<p>Since <a href="#m_macro"><code>macro(&#8230;&#8203;)</code></a> does not support <a href="#m5_aftermath">Aftermath</a>, it is not recommended to use <a href="#m_macro"><code>macro(&#8230;&#8203;)</code></a> with a body argument.</p>
</div>
</div>
<div class="sect3">
<h4 id="m5_tail_recursion">3.10.9. Tail Recursion</h4>
<div class="paragraph">
<p>Recursive calls tend to grow the stack significantly, and this can result in an error (see <a href="#v_recursion_limit"><code>$recursion_limit</code></a>) as well
inefficiency. When recursion is the last act of the function ("tail recursion"), the recursion can be performed in
aftermath to avoid growing the stack. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>fn(my_fn, First, ..., {
   ...
   ~unless(m5_Done, [
      ...
      on_return(my_fn\m5_comma_args())
   ])
   ...
})</pre>
</div>
</div>
</div>
</div>
<div class="sect2">
<h3 id="m5_block_labels">3.11. Block Labels</h3>
<div class="paragraph">
<p>Code can be nested within several layers of code blocks. Generally, code evaluates sequentially within its
block, but it can be useful to pre-evaluate code. Block labels provide convenient syntax for this.</p>
</div>
<div class="paragraph">
<p>In the simple example below, <code>h</code> is a label for the code block.</p>
</div>
<div class="literalblock">
<div class="content">
<pre>code(hello, h:{
   "Hello, " h:$Name "." |
})</pre>
</div>
</div>
<div class="paragraph">
<p>The label is used within the block as <code>h:$Name</code>, providing scope to the variable <code>$Name</code>.
<code>h:$Name</code> takes on the value of <code>Name</code> outside of the block labeled <code>h</code>. It evaluates when the <code>h</code>
block is parsed. The above is equivalent to:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>code(hello, {
   "Hello, "} $Name {"."
})</pre>
</div>
</div>
<div class="paragraph">
<p>but the use of labels allows us to align <code>{</code>/<code>}</code> pairs more naturally (and legally, see <a href="#xxx">[xxx]</a>). Also,
consider the modification without the use of a label:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>code(hello, {
   if($Cond, {
      "Hello, "} $Name {"."
   }
})</pre>
</div>
</div>
<div class="paragraph">
<p>This modification would no longer evaluate <code>$Name</code> at the time of the code definition, whereas the
labeled reference is more explicit and avoids this easy mistake. Note that the following would,
in concept, fix this bug:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>code(hello, {
   if($Cond, {
      "Hello, "}} $Name {{"."
   }
})</pre>
</div>
</div>
<div class="paragraph">
<p>though this is not permitted due to the apparent mismatching parentheses and for its lack of readability.
(See <a href="#xxx">[xxx]</a>.) The correct code, using a label, is:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>code(hello, h:{
   "Hello, " h:$Name "."
})</pre>
</div>
</div>
<div class="paragraph">
<p>Labels may be associated with calls (<code>label:foo()</code>) and variables (<code>label:$Foo</code>).</p>
</div>
<div class="literalblock">
<div class="content">
<pre>label:foo(a1)          # Evaluates using the definition of `foo` at the time the labeled block is parsed.
label:(foo(a1)...)     # Evaluates `call(foo, a1)...` at the time the labeled block is parsed. (Continue applying the label
                       # through the argument list.) Maybe, no. Just require `var(tmp, foo(a1)...)` outside, then `label:$tmp`??</pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="m5_string_labels">3.12. String Labels</h3>
<div class="paragraph">
<p>String labels use a similar syntax to <a href="#m5_block_labels">Block Labels</a>, but they serve a different purpose. They
have no impact functionally. Instead they are used to convey to an editor or IDE the syntax used in a
multiline string. For example, if Tilde is being used to process Python code, the following might be
used:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>set(MyPythonCode, python:&lt;"&gt;
  def foo():
    print("Hello, world!")
&lt;"&gt;)</pre>
</div>
</div>
<div class="paragraph">
<p>An editor that recognizes the <code>python:</code> label might provide appropriate syntax highlighting for the
Python code.</p>
</div>
</div>
<div class="sect2">
<h3 id="m5_syntax_configuration">3.13. Syntax Configuration</h3>

</div>
</div>
</div>
<div class="sect1">
<h2 id="m5_writing_tilde_code">4. Writing Tilde Code</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="m5_code_formatting">4.1. Code Formatting</h3>

</div>
<div class="sect2">
<h3 id="m5_unquoted_character_restrictions">4.2. Unquoted Character Restrictions</h3>
<div class="paragraph">
<p>There are restrictions on the use of unquoted characters in arguments. This
affords greater flexibility for syntax configuration. It also encourages quoting to
avoid missing quotes around special characters.</p>
</div>
<div class="paragraph">
<p>The restrictions are different for argument text and arithmetic expressions.</p>
</div>
<div class="sect3">
<h4 id="m5_unquoted_argument_characters">4.2.1. Unquoted Argument Characters</h4>
<div class="paragraph">
<p>Unquoted text is only permitted in argument text as a string of non-whitespace characters
without other statements. This string of characters may be referred to as a "token".</p>
</div>
<div class="paragraph">
<p>Tokens may include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>word characters: <code>a-z</code>, <code>A-Z</code>, <code>0-9</code>, <code>_</code></p>
</li>
<li>
<p>some symbols: <code>~^&amp;*-+.?</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Tokens may not include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>whitespace</p>
</li>
<li>
<p>comma (<code>,</code>)</p>
</li>
<li>
<p>paired characters: <code>()[]{}&lt;&gt;</code></p>
</li>
<li>
<p>quote characters: <code>"'\`</code></p>
</li>
<li>
<p>certain symbols that have other significance by default or that may be configured to have other significance:
<code>!#@%=:;$/\\|</code></p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="m5_unquoted_arithmetic_expressions_characters">4.2.2. Unquoted Arithmetic Expressions Characters</h4>
<div class="paragraph">
<p>In arithmetic expressions, unquoted characters are free to mingle with other
statements.</p>
</div>
<div class="paragraph">
<p>Permitted characters include:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>whitespace (which is ignored and irrelevant to <a href="#m_calc"><code>calc(&#8230;&#8203;)</code></a>)</p>
</li>
<li>
<p>digits: <code>0-9</code></p>
</li>
<li>
<p>symbols: <code>+-*/!=&lt;&gt;%&amp;|</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>And these cannot be used as unquoted literal characters:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>word characters: <code>a-z</code>, <code>A-Z</code>, <code>_</code></p>
</li>
<li>
<p>paired characters: <code>()[]{}</code></p>
</li>
<li>
<p>quote characters: <code>"'\`</code></p>
</li>
<li>
<p>symbols: <code>~$#@^:;\\.?</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p><code>|</code> is not treated as a newline character in arithmetic expressions.</p>
</div>
</div>
</div>
<div class="sect2">
<h3 id="m5_constructing_code">4.3. Constructing Code</h3>
<div class="paragraph">
<p>Though rarely needed, code may be constructed from strings and converted to code using the <code>compile</code> macro.
For example this modifies the above example to call either <code>error</code>, <code>warning</code>, or <code>info</code> based on the
value of <code>ErrorLevel</code> which holds one of those three strings. (Note, there are other ways
to accomplish this.):</p>
</div>
<div class="literalblock">
<div class="content">
<pre>var(ErrorLevel, "error")  # or "warning" or "info"
...
var(BadCodeString, $ErrorLevel ("Ugh!"))
    # E.g. error("Ugh!")
var(BadCode, compile($BadCodeString))
    # E.g. {error("Ugh!")}
if($Okay, {doit()}, $BadCode)</pre>
</div>
</div>
<div class="paragraph">
<p>Code blocks can most directly be evaluated using the <code>eval</code> macro. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>eval($BadCode)   # Reports "Ugh!".</pre>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="m5_standard_library_reference">5. Standard Library Reference</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="m5_coding_paradigms_patterns_tips_tricks_and_gotchas">5.1. Coding Paradigms, Patterns, Tips, Tricks, and Gotchas</h3>
<div class="sect3">
<h4 id="masking">5.1.1. Variable Masking</h4>
<div class="paragraph">
<p>Variable "masking" is an issue that can arise when a macro has side effects determined by its arguments.
For example, an argument might specify the name of a variable to assign, or an argument might provide a body to
evaluate that could declare or assign arbitrary variables. If the macro declares a local variable,
and the side effect updates a variable by the same name, the local variable may inadvertently be the
one that is updated by the side effect. This issue is addressed differently depending
how the macro is defined. Note that using function <a href="#m5_aftermath">Aftermath</a> is the preferred method, but all
options are listed here for completeness:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Functions: Set variables using <a href="#m5_aftermath">Aftermath</a>. Using functions for variable-setting macros is preferred.</p>
</li>
<li>
<p>Macros declaring their body using a code block: Set variable using <a href="#m_out_eval"><code>out_eval(&#8230;&#8203;)</code></a>.</p>
</li>
<li>
<p>Macros declaring their body using a string: Push/pop local variables named using <code>$0__</code> prefix.</p>
</li>
</ul>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="m5_macro_library">6. Macro Library</h2>
<div class="sectionbody">
<div class="paragraph">
<p>This section documents the macros defined by the Tilde 1.0 library. Some macros documented here are
necessary to enable inclusion of this library and are, by necessity, built-into the language. This
distinction may not be documented.</p>
</div>
<div class="sect2">
<h3 id="m5_specification_conventions">6.1. Specification Conventions</h3>
<div class="paragraph">
<p>Macros are listed by category in a logical order. An alphabetical <a href="#m5_index">Index</a> of macros can be found at the end of
this document (at least in the <code>.pdf</code> version).
Macros that return integer values, unless otherwise specified, return decimal value strings. Similarly,
macro arguments that are integer values accept decimal value strings. Boolean inputs and outputs use
<code>0</code> and <code>1</code>. Behavior for other argument values is undefined if unspecified.</p>
</div>
<div class="paragraph">
<p>Resulting output text is, by default, literal (quoted). Macros named with a <code>_eval</code> suffix generally result
in text that gets evaluated.</p>
</div>
</div>
<div class="sect2">
<h3 id="m5_assigning_and_accessing_macrosvariables">6.2. Assigning and Accessing Macros/Variables</h3>
<div class="sect3">
<h4 id="m5_declaringsetting_variables">6.2.1. Declaring/Setting Variables</h4>
<div class="paragraph">
<p><a id="m_var"></a><code>var(Name, Value, &#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Declare a scoped variable. See <a href="#variables">Variables</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the variable is defined</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: variable name</p>
</li>
<li>
<p><code>Value</code>(opt) : the value for the variable</p>
</li>
<li>
<p><code>&#8230;&#8203;</code>: additional variables and values to declare (values are required)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>var(Foo, 5)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_macro"><code>macro(&#8230;&#8203;)</code></a>, <a href="#m_fn"><code>fn(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_set"></a><code>set(Name, Value)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Set the value of a scoped variable. See <a href="#variables">Variables</a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the variable&#8217;s value is set</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: variable name</p>
</li>
<li>
<p><code>Value</code>: the value</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>set(Foo, 5)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_var"><code>var(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_push_var"></a><code>push_var(Name, Value)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Declare a variable that must be explicitly popped.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the variable is defined</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: variable name</p>
</li>
<li>
<p><code>Value</code>: the value</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>push_var(Foo, 5)
...
pop(Foo)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_pop"><code>pop(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_pop"></a><code>pop(Name)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Pop a variable or traditional macro declared using <code>push_var</code> or <code>push_macro</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the macro is popped</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: variable name</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>push_var(Foo, 5)
...
pop(Foo)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_push_var"><code>push_var(&#8230;&#8203;)</code></a>, <a href="#m_push_macro"><code>push_macro(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_null_vars"></a><code>null_vars(&#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Declare variables with empty values.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the variables are declared</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>&#8230;&#8203;</code>: names of variables to declare</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="m5_declaring_macros_2">6.2.2. Declaring Macros</h4>
<div class="paragraph">
<p><a id="m_fn"></a><code>fn(&#8230;&#8203;)</code><br>
<a id="m_lazy_fn"></a><code>lazy_fn(&#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Declare a function. For details, see <a href="#m5_functions">Functions</a>. <code>fn</code> and <code>lazy_fn</code> are functionally equivalent but
have different performance profiles, and lazy functions do not support inherited (<code>^</code>) parameters.
Lazy functions wait until they are used before defining themselves, so they are generally preferred
in libraries except for the most commonly-used functions.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the function is declared</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>&#8230;&#8203;</code>: arguments and body</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>fn(add, Addend1, Addend2, {
   ~calc(Addend1 + Addend2)
})</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m5_functions">Functions</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_macro"></a><code>macro(Name, Body)</code><br>
<a id="m_null_macro"></a><code>null_macro(Name, Body)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Declare a scoped macro. See <a href="#m5_declaring_macros">Declaring Macros</a>. A null macro must produce no output.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the macro is declared</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: the macro name</p>
</li>
<li>
<p><code>Body</code>: the body of the macro</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_macro(ParseError, &lt;p&gt;[
   error(['Failed to parse $&lt;p&gt;1.'])
])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_var"><code>var(&#8230;&#8203;)</code></a>, <a href="#m_set_macro"><code>set_macro(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_set_macro"></a><code>set_macro(Name, Body)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Set the value of a scoped(?) macro. See <a href="#m5_declaring_macros">Declaring Macros</a>. Using this macro is rare.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the macro value is set</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: the macro name</p>
</li>
<li>
<p><code>Body</code>: the body of the macro</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_var"><code>var(&#8230;&#8203;)</code></a>, <a href="#m_set_macro"><code>set_macro(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_push_macro"></a><code>push_macro(Name, Body)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Push a new value of a macro that must be explicitly popped. Using this macro is rare.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the macro value is pushed</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: the macro name</p>
</li>
<li>
<p><code>Body</code>: the body of the macro</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_pop"><code>pop(&#8230;&#8203;)</code></a>, <a href="#m_macro"><code>macro(&#8230;&#8203;)</code></a>, <a href="#m_set_macro"><code>set_macro(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="m5_accessing_macrovariable_values">6.2.3. Accessing Macro/Variable Values</h4>
<div class="paragraph">
<p><a id="m_get"></a><code>get(Name)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the value of a variable without <code>$</code> substitution (even if not assigned as a string)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: name of the variable</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>var(OneDollar, ['$1.00'])
get(OneDollar)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>$1.00</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_var"><code>var(&#8230;&#8203;)</code></a>, <a href="#m_set"><code>set(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_must_exist"></a><code>must_exist(Name)</code><br>
<a id="m_var_must_exist"></a><code>var_must_exist(Name)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Ensure that the <code>Name`d macro (`must_exist</code>) or variable (<code>var_must_exist</code>) exists.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: name of the macro/variable</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="m5_code_constructs">6.3. Code Constructs</h3>
<div class="sect3">
<h4 id="m5_status_2">6.3.1. Status</h4>
<div class="paragraph">
<p><a id="v_status"></a><code>$status</code> (Universal variable)</p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>This universal variable is set as a side-effect of some macros to indicate an exceptional
condition or non-evaluation of a body argument. It may be desirable to check this condition
after calling such macros. Macros, like <code>m5_else</code> take action based on the value
of <code>m5_status</code>. An empty value indicates no special condition.
Macros either always set it (to an empty or non-empty value) or never set it. Those that set
it list this in their "Side Effect(s)".</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_fn"><code>fn(&#8230;&#8203;)</code></a>, <a href="#m_return_status"><code>return_status(&#8230;&#8203;)</code></a>, <a href="#m_else"><code>else(&#8230;&#8203;)</code></a>, <a href="#m_sticky_status"><code>sticky_status()</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="v_sticky_status"></a><code>$sticky_status</code> (Universal variable)</p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Used by the <a href="#m_sticky_status"><code>sticky_status()</code></a> macro to capture the value of <code>m5_status</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#v_status"><code>$status</code></a>, <a href="#m_sticky_status"><code>sticky_status()</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_sticky_status"></a><code>sticky_status()</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Used to capture the first non-empty status of multiple macro calls.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#v_sticky_status"><code>$sticky_status</code></a> is set to <a href="#v_status"><code>$status</code></a> if it is empty and <a href="#v_status"><code>$status</code></a> is not.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>if(m5_A &gt;= m5_Min, [''])
sticky_status()
if(m5_A &lt;= m5_Max, [''])
sticky_status()
if(m5_reset_sticky_status(), ['m5_error(m5_A is out of range.)'])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#v_status"><code>$status</code></a>, <a href="#m_sticky_status"><code>sticky_status()</code></a>, <a href="#m_reset_sticky_status"><code>reset_sticky_status()</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_reset_sticky_status"></a><code>reset_sticky_status()</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Tests and resets <a href="#v_sticky_status"><code>$sticky_status</code></a>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>[<code>0</code> / <code>1</code>] the original nullness of <a href="#v_sticky_status"><code>$sticky_status</code></a></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#v_sticky_status"><code>$sticky_status</code></a> is reset (emptied/nullified)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_sticky_status"><code>sticky_status()</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="m5_conditionals">6.3.2. Conditionals</h4>
<div class="paragraph">
<p><a id="m_if"></a><code>if(Cond, TrueBody, &#8230;&#8203;)</code><br>
<a id="m_unless"></a><code>unless(Cond, TrueBody, FalseBody)</code><br>
<a id="m_else_if"></a><code>else_if(Cond, TrueBody, &#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An if/else construct. The condition is an expression that evaluates using <a href="#m_calc"><code>calc(&#8230;&#8203;)</code></a> (generally boolean (0/1)).
The first block is evaluated if the condition is non-0 (for <code>if</code> and <code>else_if</code>) or 0 (for <code>unless</code>),
otherwise, subsequent conditions are evaluated, or if only one argument remains, it is the
final else block, and it is evaluate. (<code>unless</code> cannot have subsequent conditions.) <code>if_else</code> does
nothing if <code>m5_status</code> is initially empty.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As an alternative to providing else blocks within <code>m5_if</code>, <a href="#m_else"><code>else(&#8230;&#8203;)</code></a> and similar macros may be used subsequent to
<code>m5_if</code> / <code>m5_unless</code> and other macros producing <a href="#v_status"><code>$status</code></a>, and this may be easier to read.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the output of the evaluated body</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>status is set, empty iff a block was evaluated; side-effects of the evaluated body</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Cond</code>: the condition expression, evaluated as for <code>m5_calc</code></p>
</li>
<li>
<p><code>TrueBody</code>: the body to evaluate if the condition evaluates to true (1)</p>
</li>
<li>
<p><code>&#8230;&#8203;</code>: either a <code>FalseBody</code> or (for <code>m5_if</code> only) recursive <code>Cond</code>, <code>TrueBody</code>, <code>&#8230;&#8203;</code> arguments to evaluate if the condition evaluates to false (not 1)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>~if(m5_eq(m5_Ten, 10) &amp;&amp; m5_Val &gt; 3, [
   ~do_something(...)
], m5_Val &gt; m5_Ten, [
   ~do_something_else(...)
], [
   ~default_case(...)
])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_else"><code>else(&#8230;&#8203;)</code></a>, <a href="#m_case"><code>case(&#8230;&#8203;)</code></a>, <a href="#m_calc"><code>calc(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_if_eq"></a><code>if_eq(String1, String2, TrueBody, &#8230;&#8203;)</code><br>
<a id="m_if_neq"></a><code>if_neq(String1, String2, TrueBody, &#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>An if/else construct where each condition is a comparison of an independent pair of strings.
The first block is evaluated if the strings match (for <code>if</code>) or mismatch (for <code>if_neq</code>), otherwise, the
remaining arguments are processed in a recursive call, either comparing the next pair of strings
or, if only one argument remains, evaluating it as the final else block.</p>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<div class="title">Note</div>
</td>
<td class="content">
As an alternative to providing else blocks, <a href="#m_else"><code>else(&#8230;&#8203;)</code></a> and similar macros may be used subsequently,
and this may be easier to read.
</td>
</tr>
</table>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the output of the evaluated body</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>status is set, empty iff a body was evaluated; side-effects of the evaluated body</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>String1</code>: the first string to compare</p>
</li>
<li>
<p><code>String2</code>: the second string to compare</p>
</li>
<li>
<p><code>TrueBody</code>: the body to evaluate if the strings match</p>
</li>
<li>
<p><code>&#8230;&#8203;</code>: either a <code>FalseBody</code> or recursive <code>String1</code>, <code>String2</code>, <code>TrueBody</code>, <code>&#8230;&#8203;</code> arguments to evaluate if the strings do not match</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>~if_eq(m5_Zero, 0, [
   ~zero_is_zero(...)
], m5_calc(m5_Zero &lt; 0), 1, [
   ~zero_is_negative(...)
], [
   ~zero_is_positive(...)
])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_else"><code>else(&#8230;&#8203;)</code></a>, <a href="#m_case"><code>case(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_if_null"></a><code>if_null(Var, Body, ElseBody)</code><br>
<a id="m_if_var_def"></a><code>if_var_def(Var, Body, ElseBody)</code><br>
<a id="m_if_var_ndef"></a><code>if_var_ndef(Var, Body, ElseBody)</code><br>
<a id="m_if_defined_as"></a><code>if_defined_as(Var, Value, Body, ElseBody)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Evaluate <code>Body</code> if the named variable is empty (<code>if_null</code>), defined (<code>if_var_def</code>), not defined (<code>if_var_ndef</code>), or not defined and equal to the given value (<code>if_defined_as</code>).,
or <code>ElseBody</code> otherwise.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the output of the evaluated body</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>status is set, empty iff a body was evaluated; side-effects of the evaluated body</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Var</code>: the variable&#8217;s name</p>
</li>
<li>
<p><code>Value</code>: for <code>if_defined_as</code> only, the value to compare against</p>
</li>
<li>
<p><code>Body</code>: the body to evaluate based on `m5_Name&#8217;s existence or definition</p>
</li>
<li>
<p><code>ElseBody</code>(opt) : a body to evaluate if the condition if <code>Body</code> is not evaluated</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>if_null(Tag, [
   error(No tag.)
])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_if"><code>if(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_else"></a><code>else(Body)</code><br>
<a id="m_if_so"></a><code>if_so(Body)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Likely following a macro that sets <code>m5_status</code>, this evaluates a body if <a href="#v_status"><code>$status</code></a> is non-empty (for <code>else</code>) or empty (for <code>if_so</code>).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the output of the evaluated body</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>status is set, empty iff a body was evaluated; side-effects of the evaluated body</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Body</code>: the body to evaluate based on <a href="#v_status"><code>$status</code></a></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>~if(m5_Cnt &gt; 0, [
   decrement(Cnt)
])
else([
   ~(Done)
])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_if"><code>if(&#8230;&#8203;)</code></a>, <a href="#m_if_eq"><code>if_eq(&#8230;&#8203;)</code></a>, <a href="#m_if_neq"><code>if_neq(&#8230;&#8203;)</code></a>, <a href="#m_if_null"><code>if_null(&#8230;&#8203;)</code></a>, <a href="#m_if_def">[m_if_def]</a>, <a href="#m_if_ndef">[m_if_ndef]</a>, <a href="#m_var_regex"><code>var_regex(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_else_if_def"></a><code>else_if_def(Name, Body)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Evaluate <code>Body</code> iff the `Name`d variable is defined.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the output of the evaluated body</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>status is set, empty iff a body was evaluated; side-effects of the evaluated body</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: the name of the case variable whose value to compare against all cases</p>
</li>
<li>
<p><code>Body</code>: the body to evaluate based on <a href="#v_status"><code>$status</code></a></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_set(Either, if_var_def(First, m5_First)m5_else_if_def(Second, m5_Second))</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_else_if"><code>else_if(&#8230;&#8203;)</code></a>, <a href="#m_if_def">[m_if_def]</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_case"></a><code>case(Name, Value, TrueBody, &#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Similar to <a href="#m_if"><code>if(&#8230;&#8203;)</code></a>, but each condition is a string comparison against a value in the <code>Name</code> variable.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the output of the evaluated body</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>status is set, empty iff a block was evaluated; side-effects of the evaluated body</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: the name of the case variable whose value to compare against all cases</p>
</li>
<li>
<p><code>Value</code>: the first string value to compare <code>VarName</code> against</p>
</li>
<li>
<p><code>TrueBody</code>: the body to evaluate if the strings match</p>
</li>
<li>
<p><code>&#8230;&#8203;</code>: either a <code>FalseBody</code> or recursive <code>Value</code>, <code>TrueBody</code>, <code>&#8230;&#8203;</code> arguments to evaluate if the strings do not match</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>~case(Response, ok, [
   ~ok_response(...)
], bad, [
   ~bad_response(...)
], [
   error(Unrecognized response: m5_Response)
])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_else"><code>else(&#8230;&#8203;)</code></a>, <a href="#m_case"><code>case(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="m5_loops">6.3.3. Loops</h4>
<div class="paragraph">
<p><a id="m_loop"></a><code>loop(InitList, DoBody, WhileCond, WhileBody)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A generalized loop construct. Implicit variable <code>m5_LoopCnt</code> starts at 0 and increments by 1
with each iteration (after both blocks).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>output of the blocks</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>side-effects of the blocks</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>InitList</code>: a parenthesized list, e.g. <code>(Foo, 5, Bar, ok)</code> of at least one variable, initial-value pair providing variables scoped to the loop, or <code>['']</code></p>
</li>
<li>
<p><code>DoBody</code>: a block to evaluate before evaluating <code>WhileCond</code></p>
</li>
<li>
<p><code>WhileCond</code>: an expression (evaluated with <a href="#m_calc"><code>calc(&#8230;&#8203;)</code></a>) that determines whether to continue the loop</p>
</li>
<li>
<p><code>WhileBody</code>(opt) : a block to evaluate if <code>WhileCond</code> evaluates to true (1)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>~loop((MyVar, 0), [
   ~do_stuff(...)
], m5_LoopCnt &lt; 10, [
   ~do_more_stuff(...)
])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_repeat"><code>repeat(&#8230;&#8203;)</code></a>, <a href="#m_for"><code>for(&#8230;&#8203;)</code></a>, <a href="#m_calc"><code>calc(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_repeat"></a><code>repeat(Cnt, Body)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Evaluate a block a predetermined number of times. Implicit variable <code>m5_LoopCnt</code> starts at 0
and increments by 1 with each iteration.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>output of the block</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>side-effects of the block</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Cnt</code>: the number of times to evaluate the body</p>
</li>
<li>
<p><code>Body</code>: a block to evaluate <code>Cnt</code> times</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>~repeat(10, [
   ~do_stuff(...)
])  //{empty}/ Iterates m5_LoopCnt 0..9.</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_loop"><code>loop(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_for"></a><code>for(Var, List, Body)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Evaluate a block for each item in a listed. Implicit variable <code>m5_LoopCnt</code> starts at 0
and increments by 1 with each iteration.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>output of the block</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>side-effects of the block</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Var</code>: the loop item variable</p>
</li>
<li>
<p><code>List</code>: a list of items to iterate over, the last of which will be skipped if empty; for each item, <code>Var</code> is set to the item, and <code>Body</code> is evaluated</p>
</li>
<li>
<p><code>Body</code>: a block to evaluate for each item</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>~for(fruit, ['apple, orange, '], [
   ~do_stuff(...)
])  //{empty}/ (also maintains m5_LoopCnt)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_loop"><code>loop(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="m5_recursion_2">6.3.4. Recursion</h4>
<div class="paragraph">
<p><a id="m_recurse"></a><code>recurse(max_depth, macro, &#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Call a macro recursively to a given maximum recursion depth. Functions have a built-in recursion
limit, so this is only useful for macros.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the output of the recursive call</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the side effects of the recursive call</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>max_depth</code>: the limit on the depth of recursive calls made through this macro</p>
</li>
<li>
<p><code>macro</code>: the recursive macro to call</p>
</li>
<li>
<p><code>&#8230;&#8203;</code>: arguments for <code>macro</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_recurse(20, myself, args)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#v_recursion_limit"><code>$recursion_limit</code></a>, <a href="#m_on_return"><code>on_return(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="m5_working_with_strings">6.4. Working with Strings</h3>
<div class="sect3">
<h4 id="m5_special_characters">6.4.1. Special Characters</h4>
<div class="paragraph">
<p><a id="m_nl"></a><code>nl()</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Produce a new-line. Programmatically-generated output should always use this macro
(directly or indirectly) to produce new-lines, rather than using an actual new-line in
the source file. Thus the input file formatting can reflect the code structure, not the output
formatting.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>a new-line</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_open_quote"></a><code>open_quote()</code><br>
<a id="m_close_quote"></a><code>close_quote()</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Produce an open or close quote. These should rarely (never?) be needed and should be used with extra
caution since they can create undetected imbalanced quoting. The resulting quote is literal,
but it will be interpreted as a quote if evaluated.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the literal quote</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_quote"><code>quote(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="v_arg_comma"></a><code>$arg_comma</code> (Universal variable)</p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A macro argument separator comma.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#Literal Commas">[Literal Commas]</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_orig_open_quote"></a><code>orig_open_quote()</code><br>
<a id="m_orig_close_quote"></a><code>orig_close_quote()</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Produce <code>['</code> or <code>']</code>. These quotes in the original file are translated internally to ASCII
control characters, and in output (STDOUT and STDERR) these control characters are translated to single-unicode-character
"printable quotes". This original quote syntax is most easily produced using these macros, and
once produced, has no special meaning in strings (though <code>[</code> and <code>]</code> have special meaning in
regular expressions).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the literal quote</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_printable_open_quote"><code>printable_open_quote()</code></a>, <a href="#m_printable_close_quote"><code>printable_close_quote()</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_printable_open_quote"></a><code>printable_open_quote()</code><br>
<a id="m_printable_close_quote"></a><code>printable_close_quote()</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Produce the single unicode character used to represent <code>['</code> or <code>']</code> in output (STDOUT and STDERR).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the printable quote</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_orig_open_quote"><code>orig_open_quote()</code></a>, <a href="#m_orig_close_quote"><code>orig_close_quote()</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_UNDEFINED"></a><code>UNDEFINED()</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>A unique untypeable value indicating that no assignment has been made.
This is not used by any standard macro, but is available for explicit use.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the value indicating "undefined"</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_var(Foo, m5_UNDEFINED)
m5_if_eq(Foo, m5_UNDEFINED, ['['Foo is undefined.']'])
R: Foo is undefined.</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="m5_slicing_and_dicing_strings">6.4.2. Slicing and Dicing Strings</h4>
<div class="paragraph">
<p><a id="m_append_var"></a><code>append_var(Name, String)</code><br>
<a id="m_prepend_var"></a><code>prepend_var(Name, String)</code><br>
<a id="m_append_macro"></a><code>append_macro(Name, String)</code><br>
<a id="m_prepend_macro"></a><code>prepend_macro(Name, String)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Append or prepend to a variable or macro. (A macro evaluates its context; a variable does not.)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: the variable name</p>
</li>
<li>
<p><code>String</code>: the string to append/prepend</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_var(Hi, ['Hello'])
m5_append_var([', ']m5_Name['!'])
m5_Hi</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>Hello, Joe!</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_substr"></a><code>substr(String, From, Length)</code><br>
<a id="m_substr_eval"></a><code>substr_eval(String, From, Length)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Extract a substring from <code>String</code> starting from <code>Index</code> and extending for <code>Length</code> ASCII characters (unicode bytes)
or to the end of the
string if <code>Length</code> is omitted or exceeds the string length. The first character of the string has index 0.
The result is empty if there is an error parsing <code>From</code> or <code>Length</code>, if <code>From</code> is beyond the end of the string,
or if <code>Length</code> is negative.</p>
</div>
<div class="paragraph">
<p>Extracting substrings from strings with quotes is dangerous as it can lead to imbalanced quoting.
If the resulting string would contain any quotes, an error is reported suggesting the use of <code>dequote</code> and <code>requote</code>
and the resulting string has its quotes replaced by control characters.</p>
</div>
<div class="paragraph">
<p>Extracting substrings from UTF-8 strings (supporting unicode characters) is also dangerous. Tilde
treats characters as bytes and UTF-8 characters can use multiple bytes, so substrings can split
UTF-8 characters. Such split UTF-8 characters will result in bytes/Tilde-characters that have no
special treatment in Tilde. They can be rejoined to reform valid UTF-8 strings.</p>
</div>
<div class="paragraph">
<p>When evaluating substrings, care must be taken with <code>,</code>, <code>(</code>, and <code>)</code> because of their meaning in argument parsing.</p>
</div>
<div class="paragraph">
<p><code>substr</code> is a slow operation relative to <code>substr_eval</code> (due to limitations of M4).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the substring or its evaluation</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>String</code>: the string</p>
</li>
<li>
<p><code>From</code>: the starting position of the substring</p>
</li>
<li>
<p><code>Length</code>(opt) : the length of the substring</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_substr(['Hello World!'], 3, 5)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>lo Wo</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_dequote"><code>dequote(&#8230;&#8203;)</code></a>, <a href="#m_requote"><code>requote(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_join"></a><code>join(Delimiter, &#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the arguments, delimited by the given delimiter string</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Delimiter</code>: text to delimit arguments</p>
</li>
<li>
<p><code>&#8230;&#8203;</code>: arguments to concatenate (with delimitation)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_join([', '], ['one'], ['two'], ['three'])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>one, two, three</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_translit"></a><code>translit(String, InChars, OutChars)</code><br>
<a id="m_translit_eval"></a><code>translit_eval(String, InChars, OutChars)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Transliterate a string, providing a set of character-for-character substitutions (where a character
is a unicode byte). <code>translit_eval</code> evaluates the resulting string.
Note that <code>['</code> and <code>']</code> are internally single characters. It is possible to
substitute these quotes (if balanced in the string and in the result) using <code>translit_eval</code> but not using <code>translit</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the transliterated string (or its evaluation for <code>translit_eval</code>)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>for <code>translit_eval</code>, the side-effects of the evaluation</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>String</code>: the string to tranliterate</p>
</li>
<li>
<p><code>InChars</code>: the input characters to replace</p>
</li>
<li>
<p><code>OutChars</code>: the corresponding character replacements</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_translit(['Testing: 1, 2, 3.'], ['123'], ['ABC'])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>Testing: A, B, C.</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_uppercase"></a><code>uppercase(String)</code><br>
<a id="m_lowercase"></a><code>lowercase(String)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Convert upper-case ASCII characters to lower-case.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the converted string</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>String</code>: the string</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_uppercase(['Hello!'])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>HELLO!</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_replicate"></a><code>replicate(Cnt, String)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Replicate a string the given number of times. (A non-evaluating version of <code>m5_repeat</code>.)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the replicated string</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Cnt</code>: the number of repetitions</p>
</li>
<li>
<p><code>String</code>: the string to repeat</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_replicate(3, ['.'])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>...</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_repeat"><code>repeat(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_strip_trailing_whitespace_from"></a><code>strip_trailing_whitespace_from(Var)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Strip trailing whitespace from the given variable.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the variable is updated</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Var</code>: the variable</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="m5_formatting_strings">6.4.3. Formatting Strings</h4>
<div class="paragraph">
<p><a id="m_format_eval"></a><code>format_eval(string, &#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Produce formatted output, much like the C <code>printf</code> function. The <code>string</code> argument may contain <code>%</code>
specifications that format values from <code>&#8230;&#8203;</code> arguments.</p>
</div>
<div class="paragraph">
<p>From the <a href="https://www.gnu.org/software/m4/manual/m4.html#Format">M4 Manual</a>, <code>%</code> specifiers include
<code>c</code>, <code>s</code>, <code>d</code>, <code>o</code>, <code>x</code>, <code>X</code>, <code>u</code>, <code>a</code>, <code>A</code>, <code>e</code>, <code>E</code>, <code>f</code>, <code>F</code>, <code>g</code>, <code>G</code>, and <code>%</code>. The following are also supported:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>field widths and precisions</p>
</li>
<li>
<p>flags <code>+</code>, <code>-</code>, ` <code>, `0</code>, <code>#</code>, and <code>'</code></p>
</li>
<li>
<p>for integer specifiers, the width modifiers <code>hh</code>, <code>h</code>, and <code>l</code></p>
</li>
<li>
<p>for floating point specifiers, the width modifier <code>l</code></p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Items not supported include positional arguments, the <code>n</code>, <code>p</code>, <code>S</code>, and <code>C</code> specifiers, the <code>z</code>,
<code>t</code>, <code>j</code>, <code>L</code> and <code>ll</code> modifiers, escape sequences, and any platform extensions available in the native printf (for example,
<code>%a</code> is supported even on platforms that haven’t yet implemented C99 hexadecimal floating point output natively).</p>
</div>
<div class="paragraph">
<p>For more details on the functioning of <code>printf</code>, see the C Library Manual, or the POSIX specification.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the formatted string</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>string</code>: the string to format</p>
</li>
<li>
<p><code>&#8230;&#8203;</code>: values to format, one for each <code>%</code> sequence in <code>string</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>1: m5_var(Foo, Hello)
   m5_format_eval(`String "%s" uses %d chars.', Foo, m5_length(Foo))
2: m5_format_eval(`%*.*d', `-1', `-1', `1')
3: m5_format_eval(`%.0f', `56789.9876')
4: m5_length(m5_format(`%-*X', `5000', `1'))
5: m5_format_eval(`%010F', `infinity')
6: m5_format_eval(`%.1A', `1.999')
7: m5_format_eval(`%g', `0xa.P+1')</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>1:
   String "Hello" uses 5 chars.
2: 1
3: 56790
4: 5000
5:        INF
6: 0X2.0P+0
7: 20</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="m5_inspecting_strings">6.4.4. Inspecting Strings</h4>
<div class="paragraph">
<p><a id="m_length"></a><code>length(String)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the length of a string in ASCII characters (unicode bytes)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>String</code>: the string</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_index_of"></a><code>index_of(String, Substring)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the position in a string in ASCII characters (unicode bytes) of the first occurence of a given substring or -1 if not present, where the string starts with character zero</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>String</code>: the string</p>
</li>
<li>
<p><code>Substring</code>: the substring to find</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_num_lines"></a><code>num_lines(String)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the number of new-lines in the given string</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>String</code>: the string</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_for_each_line"></a><code>for_each_line(Text, Body)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Evaluate <code>m5_Body</code> for every line of <code>m5_Text</code>, with <code>m5_Line</code> assigned to the line (without any new-lines).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>output from <code>m5_Body</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>side-effects of <code>m5_Body</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Text</code>: the block of text</p>
</li>
<li>
<p><code>Body</code>: the body to evaluate for every <code>m5_if</code> of <code>m5_Text</code></p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="m5_safely_working_with_strings">6.4.5. Safely Working with Strings</h4>
<div class="paragraph">
<p><a id="m_dequote"></a><code>dequote(String)</code><br>
<a id="m_requote"></a><code>requote(String)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>For strings that may contain quotes, working with substrings can lead to imbalanced quotes
and unpredictable behavior. <code>dequote</code> replaces quotes for (different) control-character/byte quotes, aka "surrogate-quotes"
that have no special meaning. Dequoted strings can be safely sliced and diced, and once reconstructed into
strings containing balanced (surrogate) quotes, dequoted strings can be requoted using <code>requote</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>dequoted or requoted string</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>String</code>: the string to dequote or requote</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_output_with_restored_quotes"></a><code>output_with_restored_quotes(String)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the given string with quotes, surrogate quotes and printable quotes replaced by their original format ([''])</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>String</code>: the string to output</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_printable_open_quote"><code>printable_open_quote()</code></a>, <a href="#m_printable_close_quote"><code>printable_close_quote()</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_no_quotes"></a><code>no_quotes(String)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Assert that the given string contains no quotes.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>String</code>: the string to test</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="m5_regular_expressions">6.4.6. Regular Expressions</h4>
<div class="paragraph">
<p>Regular expressions in Tilde use the same regular expression syntax as GNU Emacs. (See
<a href="https://www.gnu.org/software/emacs/manual/html_node/emacs/Regexps.html">GNU Emacs Regular Expressions</a>.)
This syntax is similar to BRE, Basic Regular Expressions in POSIX and is regrettably rather limited.
Extended Regular Expressions are not supported.</p>
</div>
<div class="paragraph">
<p><a id="m_regex"></a><code>regex(String, Regex, Replacement)</code><br>
<a id="m_regex_eval"></a><code>regex_eval(String, Regex, Replacement)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Searches for the first occurence of <code>Regexp</code> in <code>String</code>, resulting in either the position of the match
or its replacement.</p>
</div>
<div class="paragraph">
<p><code>Replacement</code> provides the output text. It may contain references to subexpressions of <code>Regex</code> to expand
in the output. In <code>Replacement</code>, <code>\n</code> references the nth parenthesized subexpression of <code>Regexp</code>, up to nine
subexpressions, while <code>\&amp;</code> refers to the text of the entire regular expression matched. For all other
characters, a preceding <code>\</code> treats the character literally.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>If <code>Replacement</code> is omitted, the index of the first match of <code>Regexp</code> in <code>String</code> is produced (where the
first character in the string has an index of 0), or -1 is produced if there is no match.</p>
</div>
<div class="paragraph">
<p>If <code>Replacement</code> is given and there was a match, this argument provides the output, with <code>\n</code>
replaced by the corresponding matched subexpressions of <code>Regex</code> and <code>\&amp;</code> replaced by the entire matched
substring. If there was no match result is empty.</p>
</div>
<div class="paragraph">
<p>The resulting text is literal for <code>regex</code> and is evaluated for <code>regex_eval</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>regex_eval</code> may result in side-effects resulting from the evaluation of <code>Replacement</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>String</code>: the string to search</p>
</li>
<li>
<p><code>Regex</code>: the regular expression to match</p>
</li>
<li>
<p><code>Replacement</code>(opt) : the replacement</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_regex_eval(['Hello there'], ['\w+'], ['First word: m5_translit(['\&amp;']).'])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>First word: Hello.</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_var_regex"><code>var_regex(&#8230;&#8203;)</code></a>, <a href="#m_if_regex"><code>if_regex(&#8230;&#8203;)</code></a>, <a href="#m_for_each_regex"><code>for_each_regex(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_var_regex"></a><code>var_regex(String, Regex, VarList)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Declare variables assigned to subexpressions of a regular expression.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>status</code> is assigned, non-empty iff no match.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>String</code>: the string to match</p>
</li>
<li>
<p><code>Regex</code>: the Gnu Emacs regular expression</p>
</li>
<li>
<p><code>VarList</code>: a list in parentheses of variables to declare for subexpressions</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_var_regex(['mul A, B'], ['^\(\w+\)\s+\(w+\),\s*\(w+\)$'], (Operation, Src1, Src2))
m5_if_so(['m5_DEBUG(Matched: m5_Src1[','] m5_Src2)'])
m5_else(['m5_error(['Match failed.'])'])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_regex"><code>regex(&#8230;&#8203;)</code></a>, <a href="#m_regex_eval"><code>regex_eval(&#8230;&#8203;)</code></a>, <a href="#m_if_regex"><code>if_regex(&#8230;&#8203;)</code></a>, <a href="#m_for_each_regex"><code>for_each_regex(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_if_regex"></a><code>if_regex(String, Regex, VarList, Body, &#8230;&#8203;)</code><br>
<a id="m_else_if_regex"></a><code>else_if_regex(String, Regex, VarList, Body, &#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>For chaining <code>var_regex</code> to parse text that could match a number of formats.
Each pattern match is in its own scope. <code>else_if_regex</code> does nothing if <code>m5_status</code> is non-empty.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>output of the matching body</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>m5_status</code> is non-null if no expression matched; side-effects of the bodies</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>String</code>: the string to match</p>
</li>
<li>
<p><code>Regex</code>: the Gnu Emacs regular expression</p>
</li>
<li>
<p><code>VarList</code>: a list in parentheses of variables to declare for subexpressions</p>
</li>
<li>
<p><code>Body</code>: the body to evaluate if the pattern matches</p>
</li>
<li>
<p><code>&#8230;&#8203;</code>: else body or additional repeated Regex, VarList, Body, &#8230;&#8203; to process if pattern doesn&#8217;t match</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>~if_regex(m5_Instruction, ['^mul\s+\(w+\),\s*\(w+\)$'], (Src1, Src2), [
   ~calc(m5_Src1 * m5_Src2)
], ['^incr\s+\(w+\)$'], (Src1), [
   ~calc(m5_Src1 + 1)
])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_var_regex"><code>var_regex(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_for_each_regex"></a><code>for_each_regex(String, Regex, VarList, Body)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Evaluate body for every pattern matching regex in the string. <a href="#v_status"><code>$status</code></a> is unassigned.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>side-effects of evaluating the body</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>String</code>: the string to match (containing at least one subexpression and no <code>$</code>)</p>
</li>
<li>
<p><code>Regex</code>: the Gnu Emacs regular expression</p>
</li>
<li>
<p><code>VarList</code>: a (non-empty) list in parentheses of variables to declare for subexpressions</p>
</li>
<li>
<p><code>Body</code>: the body to evaluate for each matching expression</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_for_each_regex(H1dd3n D1git5, ['\([0-9]\)'], (Digit), ['Found m5_Digit. '])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>Found 1. Found 3. Found 1. Found 5.</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_regex"><code>regex(&#8230;&#8203;)</code></a>, <a href="#m_regex_eval"><code>regex_eval(&#8230;&#8203;)</code></a>, <a href="#m_if_regex"><code>if_regex(&#8230;&#8203;)</code></a>, <a href="#m_else_if_regex"><code>else_if_regex(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="m5_utilities">6.5. Utilities</h3>
<div class="sect3">
<h4 id="m5_fundamental_macros">6.5.1. Fundamental Macros</h4>
<div class="paragraph">
<p><a id="m_defn"></a><code>defn(Name)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the M4 definition of a macro; note that the M4 definition is slightly different from the Tilde definition</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: the name of the macro</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_call"></a><code>call(Name, &#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Call a macro. Versus directly calling a macro, this indirect mechanism has two primary uses.
First it provides a consistent syntax for calls with zero arguments as for calls with a non-zero
number of arguments. Second, the macro name can be constructed.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the output of the called macro</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the side-effects of the called macro</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: the name of the macro to call</p>
</li>
<li>
<p><code>&#8230;&#8203;</code>: the arguments of the macro to call</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_call(error, ['Fail!'])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_comma_shift"><code>comma_shift(&#8230;&#8203;)</code></a>, <a href="#m_comma_args"><code>comma_args(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_quote"></a><code>quote(&#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>a comma-separated list of quoted arguments, i.e. <code>$@</code>, thus turning multiple arguments into a single literal string.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>&#8230;&#8203;</code>: arguments to be quoted</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_quote(A, ['B'])</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>['A'],['B']</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_nquote"><code>nquote(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_nquote"></a><code>nquote(&#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the arguments within the given number of quotes, the innermost applying individually to
each argument, separated by commas. A <code>num</code> of <code>0</code> results in the inlining of <code>$@</code>.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>&#8230;&#8203;</code>:</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>1: m5_nquote(3, A, ['m5_nl'])
2: m5_nquote(3, m5_nquote(0, A, ['m5_\nl'])xx)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>1: ['['['A'],['m5_\nl']']']
2: ['['['A'],['m5_\nlxx']']']</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_quote"><code>quote(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_eval"></a><code>eval(Expr)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Evaluate the argument.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the result of evaluating the argument</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the side-effects resulting from evaluation</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Expr</code>: the expression to evaluate</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>1: m5_eval(['m5_calc(1 + 1)'])
2: m5_eval(['m5'])_calc(1 + 1)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>1: 2
2: m5_calc(1 + 1)</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_comment"></a><code>comment(&#8230;&#8203;)</code><br>
<a id="m_nullify"></a><code>nullify(&#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>nothing at all; used to provide a comment (though <a href="#comments">[comments]</a> are preferred) or to discard the result of an evaluation</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>&#8230;&#8203;</code>:</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="m5_manipulating_macro_stacks">6.5.2. Manipulating Macro Stacks</h4>
<div class="paragraph">
<p>See <a href="#Macro Stacks">[Macro Stacks]</a>.</p>
</div>
<div class="paragraph">
<p><a id="m_get_ago"></a><code>get_ago(Name, Ago)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: variable name</p>
</li>
<li>
<p><code>Ago</code>: 0 for current definition, 1 for previous, and so on</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>*{
   var(Foo, A)
   var(Foo, B)
   ~get_ago(Foo, 1)
   ~get_ago(Foo, 0)
}</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>AB</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_depth_of"></a><code>depth_of(Name)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the number of values on a variable&#8217;s stack</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: macro name</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_depth_of(Foo)
m5_push_var(Foo, A)
m5_depth_of(Foo)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>0

1</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="m5_argument_processing">6.5.3. Argument Processing</h4>
<div class="paragraph">
<p><a id="m_shift"></a><code>shift(&#8230;&#8203;)</code><br>
<a id="m_comma_shift"></a><code>comma_shift(&#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Removes the first argument. <code>comma_shift</code> includes a leading <code>,</code> if there are more than zero arguments.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>a list of remaining arguments, or <code>['']</code> if less than two arguments</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>none</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>&#8230;&#8203;</code>: arguments to shift</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_foo(m5_shift($@))         /// $@ has at least 2 arguments
m5_call(foo['']m5_comma_shift($@)) /// $@ has at least 1 argument</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_nargs"></a><code>nargs(&#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the number of arguments given (useful for variables that contain lists)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>&#8230;&#8203;</code>: arguments</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_set(ExampleList, ['hi, there'])
m5_nargs(m5_ExampleList)
m5_nargs(m5_eval(m5_ExampleList))</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>1
2</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_argn"></a><code>argn(ArgNum, &#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the nth of the given <code>arguments</code> or <code>['']</code> for non-existent arguments</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>ArgNum</code>: the argument number (n) (must be positive)</p>
</li>
<li>
<p><code>&#8230;&#8203;</code>: arguments</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_argn(2, a, b, c)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>b</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_comma_args"></a><code>comma_args(&#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Convert a quoted argument list to a list of arguments with a preceding comma.
This is necessary to properly work with argument lists that may contain zero arguments.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>&#8230;&#8203;</code>: quoted argument list</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_call(foo['']m5_comma_args(['$@']), last)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_comma_shift"><code>comma_shift(&#8230;&#8203;)</code></a>, <a href="#m_comma_fn_args"><code>comma_fn_args()</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_echo_args"></a><code>echo_args(&#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>For rather pathological use illustrated in the example, &#8230;&#8203;</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the argument list (<code>$@</code>)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>&#8230;&#8203;</code>: the arguments to output</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_macro(append_to_paren_list, ['m5_echo_args$1, ${empty}2'])
m5_append_to_paren_list((one, two), three)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>(one,two,three)</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="m5_arithmetic_macros">6.5.4. Arithmetic Macros</h4>
<div class="paragraph">
<p><a id="m_calc"></a><code>calc(Expr, Radix, Width)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Calculate an expression.
Calculations are done with 32-bit signed integers. Overflow silently results in wraparound.
A warning is issued if division by zero is attempted, or if the expression could not be parsed.
Expressions can contain the following operators, listed in order of decreasing precedence.</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>()</code>: For grouping subexpressions</p>
</li>
<li>
<p><code>+</code>, <code>-</code>, <code>~</code>, <code>!</code>: Unary plus and minus, and bitwise and logical negation</p>
</li>
<li>
<p><code>**</code>: Exponentiation (exponent must be non-negative, and at least one argument must be non-zero)</p>
</li>
<li>
<p><code>*</code>, <code>%</code>: Multiplication, division, and modulo</p>
</li>
<li>
<p><code>+ -</code>: Addition and subtraction</p>
</li>
<li>
<p><code>&lt;&lt;</code>, <code>&gt;&gt;</code>: Shift left or right (for shift amounts &gt; 32, the amount is implicitly ANDed with <code>0x1f</code>)</p>
</li>
<li>
<p><code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&#8656;</code>: Relational operators</p>
</li>
<li>
<p><code>==</code>, <code>!=</code>: Equality operators</p>
</li>
<li>
<p><code>&amp;</code>: Bitwise AND</p>
</li>
<li>
<p><code>^</code>: Bitwise XOR (exclusive or)</p>
</li>
<li>
<p><code>|</code>: Bitwise OR</p>
</li>
<li>
<p><code>&amp;&amp;</code>: Logical AND</p>
</li>
<li>
<p><code>||</code>: Logical OR</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>All binary operators, except exponentiation, are left-associative. Exponentiation is right-associative.</p>
</div>
<div class="paragraph">
<p>Immediate values in <code>Expr</code> may be expressed in any radix (aka base) from 1 to 36 using prefixes as follows:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>(none): Decimal (base 10)</p>
</li>
<li>
<p><code>0</code>: Octal (base 8)</p>
</li>
<li>
<p><code>0x</code>: hexadecimal (base 16)</p>
</li>
<li>
<p><code>0b</code>: binary (base 2)</p>
</li>
<li>
<p><code>0r#:</code> where <code>#</code> is the radix in decimal (base <code>r</code>)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Digits are <code>0</code>, <code>1</code>, <code>2</code>, …, <code>9</code>, <code>a</code>, <code>b</code> … <code>z</code>. Lower and upper case letters can be used
interchangeably in numbers and prefixes. For radix 1, leading zeros are ignored, and all remaining
digits must be <code>1</code>.</p>
</div>
<div class="paragraph">
<p>For the relational operators, a true relation returns 1, and a false relation return 0.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the calculated value of the expression in the given <code>Radix</code>; the value is zero-extended as requested by <code>Width</code>; values may
have a negative sign (<code>-</code>) and they have no radix prefix; digits &gt; 9 use lower-case letters; output is empty if the expression is invalid</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Expr</code>: the expression to calculate</p>
</li>
<li>
<p><code>Radix</code>(opt) : the radix of the output (default 10)</p>
</li>
<li>
<p><code>Width</code>(opt) : a minimum width to which to zero-pad the result if necessary (excluding a possible negative sign)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>1: m5_calc(2**3 &lt;= 4)
2: m5_calc(-0xf, 2, 8)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>1: 0
2: -00001111</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_equate"></a><code>equate(Name, Expr)</code><br>
<a id="m_operate_on"></a><code>operate_on(Name, Expr)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Set a variable to the result of an arithmetic expression computed by <a href="#m_calc"><code>calc(&#8230;&#8203;)</code></a>. For
<code>m5_operate_on</code>, the variable value implicitly preceeds the expression, similar to <code>+=</code>, <code>*=</code>, etc. in other languages.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the variable is set</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: name of the variable to set</p>
</li>
<li>
<p><code>Expr</code>: the expression/partial-expression to evaluate</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_equate(Foo, 1+2)
m5_operate_on(Foo, * (3-1))
m5_Foo</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>6</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_set"><code>set(&#8230;&#8203;)</code></a>, <a href="#m_calc"><code>calc(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_increment"></a><code>increment(Name, Amount)</code><br>
<a id="m_decrement"></a><code>decrement(Name, Amount)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Increment/decrement a variable holding an integer value by one or by the given amount.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the variable is updated</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: name of the variable to set</p>
</li>
<li>
<p><code>Amount</code>(opt) : the integer amount to increment/decrement, defaulting to zero</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_increment(Cnt)</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_set"><code>set(&#8230;&#8203;)</code></a>, <a href="#m_calc"><code>calc(&#8230;&#8203;)</code></a>, <a href="#m_operate_on"><code>operate_on(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="m5_boolean_macros">6.5.5. Boolean Macros</h4>
<div class="paragraph">
<p>These have boolean (<code>0</code> / <code>1</code>) results. Note that some <a href="#m_calc"><code>calc(&#8230;&#8203;)</code></a> expressions result in boolean values as well.</p>
</div>
<div class="paragraph">
<p><a id="m_is_null"></a><code>is_null(Name)</code><br>
<a id="m_isnt_null"></a><code>isnt_null(Name)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>[<code>0</code> / <code>1</code>] indicating whether the value of the given variable (which must exist) is empty</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: the variable name</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_eq"></a><code>eq(String1, String2, &#8230;&#8203;)</code><br>
<a id="m_neq"></a><code>neq(String1, String2, &#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>[<code>0</code> / <code>1</code>] indicating whether the given <code>String1</code> is/is-not equivalent to <code>String2</code> or any of the remaining string arguments</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>String1</code>: the first string</p>
</li>
<li>
<p><code>String2</code>: the second string</p>
</li>
<li>
<p><code>&#8230;&#8203;</code>: further strings to also compare</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_if(m5_neq(m5_Response, ok, bad), ['m5_error(Unknown response: m5_Response.)'])</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="m5_within_functions_or_code_blocks">6.5.6. Within Functions or Code Blocks</h4>
<div class="paragraph">
<p><a id="m_fn_args"></a><code>fn_args()</code><br>
<a id="m_comma_fn_args"></a><code>comma_fn_args()</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>m5_fn_args()</code> results in an unquoted list containing the numbered argument (each individually quoted) of the current function.
This is like <code>$@</code>, but it can be more convenient in nested functions where the use of
<a href="#block_labels">[block_labels]</a> (e.g. <code>$&lt;label&gt;@</code>) would be needed. <code>m5_comma_fn_args()</code> is the same, but has a preceeding comma if the list is
non-empty. Note that these can be used as variables (<code>m5_fn_args</code> and <code>m5_comman_fn_args</code>) to provide quoted versions of these.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>none</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_foo(1, m5_fn_args())           /// works for 1 or more fn_args
m5_foo(1['']m5_comma_fn_args())   /// works for 0 or more fn_args</pre>
</div>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_fn_arg"><code>fn_arg(&#8230;&#8203;)</code></a>, <a href="#m_fn_arg_cnt"><code>fn_arg_cnt()</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_fn_arg"></a><code>fn_arg(Num)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Access a function argument by position from <code>m5_fn_args</code>.
This is like, e.g. <code>$3</code>, but it can be more convenient in nested functions where the use of
<a href="#block_labels">[block_labels]</a> (e.g. <code>$&lt;label&gt;3</code>) would be needed, and
can be parameterized (e.g. <code>m5_fn_arg(m5_ArgNum)</code>).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the argument value.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Num</code>: the argument number</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_fn_args"><code>fn_args()</code></a>, <a href="#m_fn_arg_cnt"><code>fn_arg_cnt()</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_fn_arg_cnt"></a><code>fn_arg_cnt()</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>The number of arguments in <code>m5_fn_args</code> or <code>$#</code>.
This is like, e.g. <code>$#</code>, but it can be more convenient in nested functions where the use of
<a href="#block_labels">[block_labels]</a> (e.g. <code>$&lt;label&gt;#</code>) would be needed.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>the argument value.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_fn_args"><code>fn_args()</code></a>, <a href="#m_fn_arg"><code>fn_arg(&#8230;&#8203;)</code></a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_out"></a><code>out(String)</code><br>
<a id="m_out_eval"></a><code>out_eval(String)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>These append to code block output that is expanded after the evaluation of the block. <code>m5_out</code> captures
literal text, while the argument to <code>m5_out_eval</code> gets evaluated. Thus <code>m5_out_eval</code> is useful for code
block side effects. <code>m5_out</code> is useful only in pathological cases within statements and by dynamically
constructed code since the shorthand syntax <code>~(&#8230;&#8203;)</code> is effectively identical to <code>~out(&#8230;&#8203;)</code>.
Note that these macros are not recommended for use in function blocks as functions have their own
mechanism for side effects that applies outside of the function (after popping parameters). (See <a href="#m5_aftermath">Aftermath</a>.)</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>no direct output, though, since these indirectly result in output as a side-effect, it is recommended to use <code>~</code>
statement syntax with these</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>indirectly, <code>out_eval</code> can result in the side effects of its output expression</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>String</code>: the string to output</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m5_code_blocks">Code Blocks</a>, <a href="#m5_aftermath">Aftermath</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_return_status"></a><code>return_status(Value)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Provide return status. (Shorthand for <code>m5_on_return(set, status, m5_Value)</code>.) This negates any prior calls
to <code>return_status</code> from the same function.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>sets <code>m5_status</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Value</code>(opt) : the status value to return, defaulting to the current value of <code>m5_status</code></p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">See also:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><a href="#m_on_return"><code>on_return(&#8230;&#8203;)</code></a>, <a href="#v_status"><code>$status</code></a>, <a href="#returning_status">Returning Status</a>, <a href="#m5_aftermath">Aftermath</a></p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_on_return"></a><code>on_return(&#8230;&#8203;, D, MacroName, &#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>&#8230;&#8203;</code></p>
</li>
<li>
<p><code>D</code>: Call a macro upon returning from a function. Arguments are those for m5_call.</p>
</li>
<li>
<p><code>MacroName</code>: the name of the macro to call</p>
</li>
<li>
<p><code>&#8230;&#8203;</code>: its arguments</p>
</li>
</ol>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="sect2">
<h3 id="m5_checking_and_debugging">6.6. Checking and Debugging</h3>
<div class="paragraph">
<p><a id="m_debug_level"></a><code>debug_level(level)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Get or set the debug level.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>with zero arguments, the current debug level</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Side Effect(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>sets <code>debug_level</code></p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>level</code>(opt) : [<code>min</code>, <code>default</code>, <code>max</code>] the debug level to set</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>debug_level(max)
use(m5-1.0)</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="sect3">
<h4 id="m5_checking_and_reporting_to_stderr">6.6.1. Checking and Reporting to STDERR</h4>
<div class="paragraph">
<p>These macros output text to the standard error output stream (STDERR) (with <code>['</code> / <code>']</code> quotes represented by single characters).
(Note that STDOUT is the destination for the evaluated output.)</p>
</div>
<div class="paragraph">
<p><a id="m_errprint"></a><code>errprint(text)</code><br>
<a id="m_errprint_nl"></a><code>errprint_nl(text)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Write to STDERR stream (with a trailing new-line for <code>errprint_nl</code>).</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>text</code>: the text to output</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_errprint_nl(['Hello World.'])</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_warning"></a><code>warning(message)</code><br>
<a id="m_error"></a><code>error(message)</code><br>
<a id="m_fatal_error"></a><code>fatal_error(message)</code><br>
<a id="m_DEBUG"></a><code>DEBUG(message)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Report an error/warning/debug message and stack trace (except for <code>DEBUG</code>).
Exit for fatal_error, with non-zero exit code.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>message</code>: the message to report; (<code>Error:</code> pre-text (for example) provided by the macro)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_error(['Parsing failed.'])</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_warning_if"></a><code>warning_if(condition, message)</code><br>
<a id="m_error_if"></a><code>error_if(condition, message)</code><br>
<a id="m_fatal_error_if"></a><code>fatal_error_if(condition, message)</code><br>
<a id="m_DEBUG_if"></a><code>DEBUG_if(condition, message)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Report an error/warning/debug message and stack trace (except for <code>DEBUG_if</code>) if the given condition is true.
Exit for fatal_error, with non-zero exit code.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>condition</code>: the condition, as in <code>m5_if</code>.</p>
</li>
<li>
<p><code>message</code>: the message to report; (<code>Error:</code> pre-text (for example) provided by the macro)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_error_if(m5_Cnt &lt; 0, ['Negative count.'])</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_assert"></a><code>assert(condition)</code><br>
<a id="m_fatal_assert"></a><code>fatal_assert(condition)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Assert that a condition is true, reporting an error if it is not, e.g. <code>Error: Failed assertion: -1 &lt; 0</code>. Exit for fatal_error, with non-zero exit code.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>condition</code>: the condition to check (and report)</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_assert(m5_Cnt &lt; 0)</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_verify_min_args"></a><code>verify_min_args(Name, Min, Actual)</code><br>
<a id="m_verify_num_args"></a><code>verify_num_args(Name, Min, Actual)</code><br>
<a id="m_verify_min_max_args"></a><code>verify_min_max_args(Name, Min, Max, Actual)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Verify that a traditional macro has a minimum number, a range, or an exact number of arguments.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>Name</code>: the name of this macro (for error message)</p>
</li>
<li>
<p><code>Min</code>: the required minimum or exact number of arguments</p>
</li>
<li>
<p><code>Max</code>: the maximum number of arguments</p>
</li>
<li>
<p><code>Actual</code>: the actual number of arguments</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_verify_min_args(my_fn, 2, $#)</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
<div class="sect3">
<h4 id="m5_uncategorized_debug_macros">6.6.2. Uncategorized Debug Macros</h4>
<div class="paragraph">
<p><a id="v_recursion_limit"></a><code>$recursion_limit</code> (Universal variable)</p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>If the function call stack exceeds this value, a fatal error is reported.</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p><a id="m_abbreviate_args"></a><code>abbreviate_args(max_args, max_arg_length, &#8230;&#8203;)</code></p>
</div>
<table class="tableblock frame-none grid-none stretch">
<colgroup>
<col style="width: 16.6666%;">
<col style="width: 83.3334%;">
</colgroup>
<tbody>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Description:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>For reporting messages containing argument lists, abbreviate long arguments and/or a long argument list by replacing
   long input args and remaining arguments beyond a limit with ['&#8230;&#8203;'].</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Output:</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>a quoted string of quoted args with a comma preceding every arg.</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Parameter(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="olist arabic">
<ol class="arabic">
<li>
<p><code>max_args</code>: if more than this number of args are given, additional args are represented as ['&#8230;&#8203;']</p>
</li>
<li>
<p><code>max_arg_length</code>: maximum length in characters to display of each argument</p>
</li>
<li>
<p><code>&#8230;&#8203;</code>: arguments to represent in output</p>
</li>
</ol>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-right valign-top"><p class="tableblock">Example(s):</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="literalblock">
<div class="content">
<pre>m5_abbreviate_args(5, 15, $@)</pre>
</div>
</div></div></td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="m5_reference_card">7. Reference Card</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Tilde processes the following syntaxes:</p>
</div>
<table id="syntax_table" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 1. Core Syntax</caption>
<colgroup>
<col style="width: 21.4285%;">
<col style="width: 14.2857%;">
<col style="width: 28.5714%;">
<col style="width: 21.4285%;">
<col style="width: 14.2859%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Feature</th>
<th class="tableblock halign-left valign-top">Reference</th>
<th class="tableblock halign-left valign-top">Syntax</th>
<th class="tableblock halign-left valign-top">Contexts</th>
<th class="tableblock halign-left valign-top">Must Be Evaluated?</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tilde comments</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Comments">[Comments]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>///</code>, <code>/**</code>, <code>**/</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>N/A</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quotes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Quotes">[Quotes]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>['</code>, <code>']</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Yes</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Macro calls</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Calling Macros">[Calling Macros]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">e.g. <code>m5_my_fn(arg1, arg2)</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All (except as code statement)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Yes</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Numbered/special parameters</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#m5_declaring_macros">Declaring Macros</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$</code> (e.g. <code>$3</code>, <code>$@</code>, <code>$#</code>, <code>$*</code>)</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Within outermost macro/function (not var) definition body</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>N/A</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Escapes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#prefix_escapes">[prefix_escapes]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>\m5_foo</code>, <code>m5_\foo</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>\m5_foo</code>-Yes, <code>m5_\foo</code>-Must not</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>The contexts listed under the "Contexts" column of <a href="#syntax_table">Core Syntax</a> are described in <a href="#Contexts">[Contexts]</a>. "Yes" in the
"Must Be Evaluated" column indicates that the syntax should not pass through to the output without being evaluated.
Doing so may result in an error or unexpected output text.</p>
</div>
<div class="paragraph">
<p>Additionally, text and code block syntax is recognized when special quotes are opened at the end of a line or closed
at the beginning of a line. See <a href="#m5_code_blocks">Code Blocks</a>. For example:</p>
</div>
<div class="literalblock">
<div class="content">
<pre>/Report error.
error(*&lt;blk&gt;{
   ~(['Something went wrong!'])
})</pre>
</div>
</div>
<div class="paragraph">
<p>Block syntax incudes:</p>
</div>
<table id="block_syntax" class="tableblock frame-all grid-all stretch">
<caption class="title">Table 2. Block Syntax</caption>
<colgroup>
<col style="width: 25%;">
<col style="width: 16.6666%;">
<col style="width: 33.3333%;">
<col style="width: 25.0001%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Feature</th>
<th class="tableblock halign-left valign-top">Reference</th>
<th class="tableblock halign-left valign-top">Syntax</th>
<th class="tableblock halign-left valign-top">Contexts</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code block quotes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#m5_code_blocks">Code Blocks</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>[</code>, <code>]</code>, <code>{</code>, <code>}</code> (ending/beginning a line)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Tilde, code</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Text block quotes</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Text Blocks">[Text Blocks]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>['</code>, <code>']</code> (ending/beginning a line)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Tilde, code</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Evaluate Blocks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#Evaluate Blocks">[Evaluate Blocks]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>*[</code>, <code>[</code>, <code>*{</code>, <code>}</code>, <code>*['</code>, <code>']</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Tilde, code</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Statement comment</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#statement_comments">[statement_comments]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>/Blah blah blah&#8230;&#8203;</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Code</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Statement with no output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#m5_code_blocks">Code Blocks</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>Foo</code>, <code>bar(&#8230;&#8203;)</code> (<code>m5_</code> prefix implied)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Code</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code block statement with output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#bCode Blocks">[bCode Blocks]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~Foo</code>, <code>~bar(&#8230;&#8203;)</code> (<code>m5_</code> prefix implied)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Code</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Code block output</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#m5_code_blocks">Code Blocks</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>~(&#8230;&#8203;)</code></p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Code</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>All syntax in <a href="#block_syntax">Block Syntax</a> must be evaluated (strictly, must not be unevaluated).</p>
</div>
<div class="paragraph">
<p>Though not essential, block labels can be used to improve maintainability and performance in extreme cases.</p>
</div>
<table class="tableblock frame-all grid-all stretch">
<caption class="title">Table 3. Block Label Syntax</caption>
<colgroup>
<col style="width: 21.4285%;">
<col style="width: 14.2857%;">
<col style="width: 28.5714%;">
<col style="width: 21.4285%;">
<col style="width: 14.2859%;">
</colgroup>
<thead>
<tr>
<th class="tableblock halign-left valign-top">Feature</th>
<th class="tableblock halign-left valign-top">Reference</th>
<th class="tableblock halign-left valign-top">Syntax</th>
<th class="tableblock halign-left valign-top">Contexts</th>
<th class="tableblock halign-left valign-top">Must Be Evaluated</th>
</tr>
</thead>
<tbody>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Named blocks</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#block_labels">[block_labels]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>&lt;foo&gt;</code> (preceding the open block quote, after optional <code>*</code>) e.g. <code>*&lt;bar&gt;{</code> or <code>&lt;baz&gt;['</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">Tilde, Code</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>Yes</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Quote escape</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#block_labels">[block_labels]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>']&lt;foo&gt;m5_Bar['</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All (within any type of Tilde quotes)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p><code>&lt;foo&gt;m5_Bar</code>-Yes</p>
</div></div></td>
</tr>
<tr>
<td class="tableblock halign-left valign-top"><p class="tableblock">Labeled number/special parameter reference</p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><a href="#block_labels">[block_labels]</a></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock"><code>$&lt;foo&gt;</code>, e.g. <code>$&lt;foo&gt;2</code> or <code>$&lt;bar&gt;#</code></p></td>
<td class="tableblock halign-left valign-top"><p class="tableblock">All (within corresponding block)</p></td>
<td class="tableblock halign-left valign-top"><div class="content"><div class="paragraph">
<p>N/A</p>
</div></div></td>
</tr>
</tbody>
</table>
<div class="paragraph">
<p>Many macros accept arguments with syntaxes of their own, defined in the macro definition. Functions, for example are fundamental. See <a href="#m5_functions">Functions</a>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="m5_index">Index</h2>
<div class="sectionbody">

</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2025-03-16 12:59:37 -0400
</div>
</div>
</body>
</html>